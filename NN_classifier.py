# first neural network with keras tutorial
from numpy import loadtxt
from keras.models import Sequential
from keras.layers import Dense
import numpy as np
import keras
import tensorflow as tf
#import keras.backend.tensorflow_backend as K
import os.path
import tempfile

#import tensorflow as tf
#from tensorflow.python.keras import Model, Sequential


#"""
#for testing here
contrast_7 =[58.20698923239739, 58.20886209408747, 58.209293664028976, 58.20828701023303, 58.21013775326271, 58.216145253140475, 58.218735556629525, 58.17950437789226, 58.20106846034332, 58.20591525991953, 58.20605285946677, 58.21354579309846, 58.214753895104764, 58.21657592513985, 58.218264849710096, 58.219835779471026, 58.22141331524596, 58.22070208576446, 58.20603251974182, 58.20707544343882, 58.206877486766906, 58.20708553755199, 58.20787319546169, 58.21117822842832, 58.20893455132673, 58.20969992640865, 58.20832874321191, 58.21106236416946, 58.20925726824814, 58.209807855340756, 58.20911019173426, 58.22641067413137, 58.21570737081419, 58.21786916395606, 58.21771975380027, 58.21854969664844, 58.217513089121454, 58.22073892760193, 58.2291754002306, 58.23383707962283, 58.23953143800558, 58.24124668842039, 58.24071251749063, 58.243913780768196, 58.24376815841268, 58.2469387844195, 58.248426884812936, 58.24819775660349, 58.24855696835681, 58.2487674305596, 58.25076732184719, 58.254364977885025, 58.252849055447285, 58.25215743537041, 58.2535993598558, 58.25582281464705, 58.2558342106752, 58.257236447899885, 58.25747333921671, 58.25808952696543, 58.25642482262877, 58.25656974405069, 58.256224004037826, 58.252847925058674, 58.25345041015918, 58.250497666623886, 58.22977607175957, 58.250555092488284, 58.25412006712657, 58.25691437444157, 58.258822621906255, 58.260370005855194, 58.263492913640654, 58.26467848029383, 58.26569520963727, 58.26698199409988, 58.266372288885975, 58.26473632447594, 58.26704233128402, 58.26805998274414, 58.26770071390625, 58.269655729240185, 58.26964358544575, 58.26912395216626, 58.270586707849766, 58.27138011947006, 58.27293846200469, 58.27614312464295, 58.276425424646796, 58.27523626088411, 58.277371301596766, 58.27729183047735, 58.277047926491875, 58.278773861324105, 58.27898956613233, 58.28214513455537, 58.28277084704647, 58.28274618723677, 58.28336191766763, 58.26357044660418, 58.264821442018636, 58.265179590455524, 58.2697744661445, 58.27188573276591, 58.26990804960931, 58.27328340090077, 58.27247392579342, 58.27224220437679, 58.27232564776359, 58.27263631483226, 58.27289789511745, 58.27288280114123, 58.27332074222894, 58.27302782486869, 58.27392619762805, 58.27336220713841, 58.273085820945376, 58.27461789455292, 58.27528810461915, 58.27627679928036, 58.277723454384, 58.277645117872595, 58.27879746733343, 58.275068293057146, 58.27535428441621, 58.269004752514824, 58.25791184543431, 58.28285640808854, 58.28698419381153, 58.28799637895726, 58.29748146568286, 58.2919222603404, 58.295373995217105, 58.28792472274442, 58.29096347058442, 58.29138350265941, 58.29342543152457, 58.29002803603616, 58.292101197126605, 58.290743595653915, 58.291308715525965, 58.29190456147567, 58.29309050767878, 58.29155477213326, 58.29387323529824, 58.29302025110348, 58.29361207521142, 58.29290039525033, 58.29299403868643, 58.294648350632094, 58.31668837405581, 58.30345510391394, 58.30936421959502, 58.30773835019958, 58.307351973824716, 58.306547572676706, 58.30884334559849, 58.30540579884129, 58.30426645373444, 58.304281784808005, 58.30527652124938, 58.303711332042205, 58.303280710416516, 58.295286273972756, 58.29202390440594, 58.297236136160805, 58.29896753164865, 58.30269674027613, 58.3034747615164, 58.30377379622313, 58.30265763672472, 58.3023858645849, 58.302358989373126, 58.30284697912856, 58.305127785494825, 58.30432498482578, 58.30384338805129, 58.30573049107769, 58.30678778083922, 58.30517407650203, 58.30802979270985, 58.307406131979235, 58.310255946368656, 58.305443349932446, 58.30065531022425, 58.29582139782798, 58.28251113391845, 58.28919267380464, 58.29005884709526, 58.29195264426426, 58.29677690656162, 58.29871547529453, 58.29902677165674, 58.299742176396926, 58.29899914363446, 58.304869699760005, 58.30621517482989, 58.31053474363089, 58.31621391414633, 58.3152125910814, 58.31832139886147, 58.320208890223874, 58.32114715564199, 58.319205114664214, 58.319477191895224, 58.31957086634562, 58.32384323762734, 58.326568160591044, 58.33329866100264, 58.32935068880108, 58.331696426234096, 58.33033475789622, 58.33503070017545, 58.3380714450147, 58.35078689645844, 58.34790017478499, 58.35884661320475, 58.34170205448931, 58.34554507801582, 58.341371362506294, 58.34232262276358, 58.340035746342316, 58.34195504316619, 58.3397796550705, 58.33988970108644, 58.346708101624074, 58.347376473238874, 58.35520770464463, 58.36303231441794, 58.36344176765481, 58.36938875323378, 58.373279072627525, 58.37333042526916, 58.37471588199556, 58.371451784400776, 58.37069135986381, 58.37325888417239, 58.37778500444736, 58.37719733807882, 58.37904543195312, 58.37696133363438, 58.378183994573995, 58.379079062813716, 58.385753025250445, 58.390966571753175, 58.3750122522003, 58.359791189357814, 58.34904071116132, 58.35206458210151, 58.34575450857516, 58.34977522511916, 58.34680262326466, 58.347471318064294, 58.34880750324498, 58.348912771365285, 58.35579053391321, 58.367722807314536, 58.37954190899839, 58.40651217772288, 58.38739642245938, 58.39415870175675, 58.40034833534217, 58.40158009492209, 58.40309605418932, 58.41390623575932, 58.413395255396544, 58.421800907102906, 58.43098484621246, 58.43781404044219, 58.437457887293554, 58.44735521781572, 58.44557079624666, 58.44678498421353, 58.46224195260076, 58.46863323673958, 58.470706405563, 58.46713204287579, 58.44276219808684, 58.43625707232589, 58.43595173326839, 58.436868045653654, 58.43268533013901, 58.433079461234875, 58.432929405325545, 58.43892790878398, 58.444337723173, 58.44460754232848, 58.46054133857149, 58.47913180821461, 58.47785167754022, 58.49592460617931, 58.51000714722815, 58.51117235705412, 58.509992182639586, 58.50589178239059, 58.50623725039919, 58.50806713799175, 58.51577357771736, 58.51582130090233, 58.53230855121483, 58.53932493612044, 58.54021969724822, 58.54416441940384, 58.551899619497895, 58.550357062355616, 58.55603636462466, 58.522918485107844, 58.524080382236754, 58.53465024945787, 58.52966542444302, 58.532756782680956, 58.52086630060312, 58.5088173624519, 58.508633862091074, 58.502657686370874, 58.49937963830093, 58.49977169087432, 58.51341861864018, 58.53340824649638, 58.53216124539802, 58.556874971029316, 58.59001640141003, 58.59852385836614, 58.61071664001445, 58.626530726013506, 58.62266136308836, 58.63977891740551, 58.63904873320133, 58.64301050282737, 58.64329388348304, 58.66269891860459, 58.65330431610348, 58.67022865743205, 58.679630073985685, 58.68708730195716, 58.70121025266917, 58.74892143493009, 58.70998784757835, 58.70658447826871, 58.71306748538121, 58.70345266322245, 58.68895566715984, 58.68900953534487, 58.676552465419945, 58.67642604873748, 58.69520562089916, 58.68289236458597, 58.69828143116251, 58.74483900368845, 58.73250191101723, 58.78193891574772, 58.81855989529269, 58.82053874530414, 58.848285296490886, 58.86366549944664, 58.858261823488284, 58.846572802648986, 58.85793445913497, 58.861696201563035, 58.863179871088285, 58.88973324481218, 58.88644038855785, 58.91416874091056, 58.9357216313808, 58.93653295633752, 58.96442061544132, 58.93803809761762, 58.93713314185446, 58.95699789845845, 58.99341122761679, 59.005496924899354, 58.965375591790355, 58.94705895642373, 58.94368567899248, 58.93300945293035, 58.94330018156603, 58.94552164687928, 58.98346546363024, 59.05110278873699, 59.05133033976744, 59.12190160163507, 59.197446352389655, 59.2016584758077, 59.2583316069921, 59.256672053590364, 59.25637375537473, 59.26263018406684, 59.29408081336941, 59.29452144026441, 59.309482294264065, 59.334773460247916, 59.335140910861575, 59.360070343071065, 59.38129851423717, 59.354424308262914, 59.366702549341944, 59.38422176637421, 59.37242400467399, 59.36558258401025, 59.30771480640588, 59.30766977129272, 59.22393308078814, 59.081182757872774, 59.07453712004986, 59.05605745095023, 59.052498151953436, 59.0573387104352, 59.03253957639098, 59.0953120480108, 59.09066469127008, 59.06110226112487, 58.99101520364773, 58.996507686418994, 58.95631133154223, 58.886912170247165, 58.89650828399339, 58.85710274340514, 58.81156851099951, 58.82310434909041, 58.80131407147632]
colorfulness_7 = [10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.090218035305282, 10.948972554536795, 10.948972554536795, 10.948972554536795, 10.948972554536795]
brightness_7 = [121.44434016551573, 121.4616139184137, 121.45621555076869, 121.45604702057598, 121.45129444751333, 121.47149734013632, 121.45575527253257, 121.33476275286496, 121.36976749128615, 121.38453496600289, 121.3667285177035, 121.36784889181841, 121.38053244243483, 121.36931617147941, 121.38376929618812, 121.40925660241383, 121.39503307596648, 121.42601546742463, 121.39024160948789, 121.40685147170521, 121.3996140641084, 121.40432491969173, 121.39169310216968, 121.41394704694763, 121.40241140372999, 121.41027663348655, 121.3945084123622, 121.40918936387574, 121.40249522545412, 121.40738744207911, 121.39715895786563, 121.45731989417577, 121.40696325374653, 121.42842634237205, 121.41752809623286, 121.41857040489045, 121.41072628797532, 121.41367977420038, 121.41203372648705, 121.41460322663747, 121.4143952580355, 121.41870168702083, 121.41173340473595, 121.4250211279349, 121.40977914138364, 121.40396780831472, 121.39737024664515, 121.40419900376907, 121.39245121574798, 121.39712063522234, 121.38804123206674, 121.40021603839038, 121.38797384389989, 121.39038354822836, 121.37865371597816, 121.39163430197866, 121.3828933380989, 121.38347034617371, 121.37659722417584, 121.38573835049125, 121.37953888256813, 121.38178197259893, 121.3745219139302, 121.38164526805072, 121.37879256478861, 121.39625921045953, 121.28213460162684, 121.28834171214174, 121.28157552783858, 121.28362751245801, 121.27635022163396, 121.29294041581818, 121.28396965326952, 121.28939823678395, 121.27858157079407, 121.28608650225327, 121.28063959018868, 121.28353375998996, 121.27853356175305, 121.28637564424552, 121.2820581482824, 121.28285991742896, 121.27755196282587, 121.28425103318114, 121.27958944529516, 121.28249419549532, 121.27681403013254, 121.2837470895861, 121.27648909476291, 121.28252109554265, 121.27391968508309, 121.28426541436986, 121.27824507917681, 121.28233344299954, 121.27530398284233, 121.28221943655721, 121.27436411487194, 121.27620297520654, 121.2670694519663, 121.25216768555167, 121.2497243851762, 121.24922594702686, 121.24190843724936, 121.25922027639008, 121.2474640048569, 121.25261142444376, 121.2411540011033, 121.25023217607972, 121.24436033961186, 121.2482948758059, 121.2402033702087, 121.24649083023401, 121.24348930524474, 121.24518567159359, 121.23788821797956, 121.2436556487427, 121.24203692128312, 121.24245697284013, 121.23803266803614, 121.24096140974879, 121.23817773767553, 121.23930980733722, 121.23568890127692, 121.24537067988554, 121.24169918398493, 121.25733954348232, 121.20002335728857, 121.28025376464868, 121.29738862156776, 121.28607741066743, 121.32996874365205, 121.29672062959042, 121.31036111618626, 121.28247579051585, 121.29512849212652, 121.28008830998327, 121.28741345403003, 121.27245395107195, 121.28056942746727, 121.27547074397873, 121.2763878772947, 121.26634714479032, 121.2760818254634, 121.27073693208565, 121.27262583263663, 121.26589073034583, 121.27290198907642, 121.26594589486281, 121.26857666517607, 121.26089644527335, 121.31924733720189, 121.25670110247414, 121.27425212117586, 121.26638795634459, 121.27036882005369, 121.25987268660182, 121.2698020905518, 121.250345418409, 121.26221149008228, 121.25198961333678, 121.25582645303933, 121.2365724978457, 121.23243976457826, 121.23105396904242, 121.21066687560223, 121.20536708945767, 121.1946210260748, 121.20222135801032, 121.1915320241332, 121.19554106695391, 121.18634288748537, 121.19406160071895, 121.19010750308553, 121.19038290948568, 121.17851621912313, 121.18533749399751, 121.18079619238415, 121.17813425448072, 121.17236889252413, 121.17856615198579, 121.17220200922597, 121.17405828197336, 121.16601228308399, 121.25012875743438, 121.22950236484779, 121.23417104266434, 121.1440791879537, 121.15940147060942, 121.17423459797543, 121.16056906904224, 121.18322072855302, 121.16949598704143, 121.17269236848269, 121.155805103962, 121.16520684774028, 121.1450821694014, 121.15274298643111, 121.13554298811582, 121.14072755993634, 121.13464823223022, 121.13545516467839, 121.12089969168412, 121.12855355647956, 121.12124975034709, 121.1221989031009, 121.1160848009484, 121.12787613990984, 121.11578179654956, 121.13610035359089, 121.10631307589293, 121.11974106934754, 121.11186704125309, 121.11510185896788, 121.1035549142641, 121.14073031485019, 121.1248396717392, 121.15527944136969, 121.08498728071751, 121.1004237661968, 121.08754113609707, 121.0918417450761, 121.07664842966678, 121.0852277664681, 121.07921815168032, 121.0798666329868, 121.06197785810281, 121.06843713367019, 121.04988662751897, 121.04082327392057, 121.03645957018628, 121.0314723054555, 121.02182684782845, 121.02363456646462, 121.01591142798674, 121.02134568156724, 121.01555285214458, 121.01406226741338, 120.99770342705663, 121.00431191291129, 120.99258983576341, 120.99507708760245, 120.99023198446093, 120.99469767591151, 120.98241732824343, 121.0132367141805, 120.95528340690652, 120.99401408941227, 120.95707258403932, 120.9935102359038, 120.9609512651987, 121.00948420465734, 121.00822104065405, 121.00814441931186, 121.00688039574416, 121.00467218574082, 120.9893996995607, 121.03866392993704, 121.01349614838034, 121.0874892061448, 120.98335778716364, 120.97310039549329, 120.95560800509047, 120.96294824903903, 120.94535472935644, 120.95831594587392, 120.95177012573467, 120.94262023215846, 120.91264683755405, 120.92572425543764, 120.89670727781268, 120.9156738085364, 120.90535691998818, 120.91217148887822, 120.8760419393091, 120.90405131833974, 120.89067734180176, 120.90831314003007, 120.83288121128817, 120.81121195536463, 120.7920199665528, 120.79973535753415, 120.78547804862716, 120.78907368144854, 120.78318841040394, 120.79864763688566, 120.77292366345606, 120.77757948134071, 120.73514670187463, 120.71201128945957, 120.7049416425878, 120.68157141344925, 120.63947848521148, 120.64638070827516, 120.62709193786635, 120.62120982598678, 120.61758342065154, 120.60846176297751, 120.5855886908835, 120.58706204520703, 120.54861374771163, 120.52781632177052, 120.52582121951937, 120.5055472589829, 120.47680116402383, 120.48393578006176, 120.45177569972428, 120.31985339997279, 120.31707755939803, 120.3097839285179, 120.29414291034092, 120.3106875975474, 120.3098265912702, 120.33388204956032, 120.32577083187066, 120.33924315693406, 120.32621797525077, 120.32886337421073, 120.28619148678601, 120.26326920353945, 120.25671362304513, 120.20046809501153, 120.11070021707975, 120.13621371984928, 120.07090126706586, 120.08108795199111, 120.06219708584288, 120.06079750418674, 119.99032515126642, 120.01578878546717, 119.96626719636932, 119.96593506315737, 119.93263639968926, 119.9498193673416, 119.8929908825325, 119.91309645933744, 119.82712685094822, 119.84497434628231, 119.7509581939717, 119.68965916141671, 119.70521631742317, 119.67008675014165, 119.723569001947, 119.77594551437144, 119.73701825635086, 119.71616436870181, 119.72551510533971, 119.68509550991935, 119.62505349990364, 119.55243852398989, 119.51813712611691, 119.46191078814032, 119.33153421751824, 119.33764688170216, 119.16404082921973, 119.14109110119276, 119.12289514266504, 119.1022078197425, 119.03682508919597, 119.04898952821657, 119.00348438903391, 118.93937948751086, 118.92861573389018, 118.87817516319443, 118.80592260976083, 118.80983812910851, 118.72215832720646, 118.58290496103648, 118.58717669851586, 118.48335559218619, 118.51146232207492, 118.5549916385506, 118.50465392409784, 118.5741666507988, 118.55550977423161, 118.54637316973479, 118.46960469363947, 118.48625210076501, 118.392197056279, 118.2553434837888, 118.2474698899015, 118.12193498236316, 118.00096042042885, 118.01381870299554, 117.88792423534431, 117.89339663690644, 117.88598919761341, 117.9163337838161, 117.89914118371735, 117.90465994494362, 117.93118927429977, 117.92602612327772, 117.92299530280533, 117.9257794196992, 117.94234130275956, 118.0623869087119, 118.07061284105595, 118.14112748872219, 118.10174808934494, 118.1497926066376, 118.2171250665699, 118.22120308562135, 118.40185848752422, 118.67980073743014, 118.65463283358926, 118.7214156152437, 118.74457271351487, 118.7560569971591, 118.77384767047906, 118.71595439923138, 118.69944373204198, 118.7063265807616, 118.73242455030213, 118.75576543758554, 118.86664707130366, 118.92875777777574, 118.96491706265212, 119.01880643527844, 119.1094155334087, 119.12200086670437, 119.15706028903632]


best_config_list_7 = ['reso_160_encode_36', 'reso_960_encode_32', 'reso_640_jpeg', 'reso_960_encode_32', 'reso_768_encode_28', 'reso_960_encode_32', 'reso_640_jpeg', 'reso_768_encode_32', 'reso_768_jpeg_encode_32', 'reso_960_encode_32', 'reso_768_jpeg_encode_32', 'reso_960_encode_32', 'reso_640_encode_24']
#'reso_640_encode_24', 'reso_960_encode_36', 'reso_640_encode_36', 'reso_480_encode_20', 'reso_768_jpeg_encode_28', 'reso_640_jpeg', 'reso_640_jpeg_encode_28', 'reso_960_encode_32', 'reso_960_encode_32', 'reso_640_encode_24', 'reso_640_jpeg_encode_28', 'reso_1440_encode_40', 'reso_768_jpeg_encode_28', 'reso_640_encode_32', 'reso_640_encode_28', 'reso_640_jpeg_encode_24', 'reso_1440_jpeg_encode_40', 'reso_480_encode_20', 'reso_1440_jpeg_encode_40', 'reso_960_encode_32', 'reso_1440_encode_40', 'reso_768_jpeg_encode_32', 'reso_480_encode_24', 'reso_640_jpeg', 'reso_768_jpeg_encode_28', 'reso_960_encode_32', 'reso_960_encode_32', 'reso_960_encode_32', 'reso_960_encode_32', 'reso_960_encode_32', 'reso_640_jpeg', 'reso_640_jpeg', 'reso_640_encode_28', 'reso_768_jpeg_encode_28', 'reso_960_encode_32', 'reso_768_jpeg_encode_28', 'reso_960_jpeg_encode_32', 'reso_960_jpeg_encode_36', 'reso_768_jpeg_encode_40', 'reso_960_encode_32', 'reso_640_jpeg', 'reso_1440_encode_40', 'reso_640_jpeg', 'reso_960_encode_32', 'reso_960_jpeg_encode_36', 'reso_960_encode_32', 'reso_768_jpeg_encode_28', 'reso_768_jpeg_encode_36', 'reso_640_jpeg', 'reso_640_jpeg', 'reso_640_jpeg_encode_36', 'reso_768_jpeg_encode_32', 'reso_960_encode_32', 'reso_960_encode_32', 'reso_960_encode_40', 'reso_768_jpeg_encode_28', 'reso_768_jpeg_encode_28', 'reso_640_encode_28', 'reso_960_encode_32', 'reso_960_encode_32', 'reso_960_encode_36', 'reso_960_encode_32', 'reso_320_encode_12', 'reso_640_encode_28', 'reso_960_encode_32', 'reso_640_encode_28', 'reso_768_jpeg_encode_28', 'reso_960_encode_40', 'reso_960_encode_32', 'reso_768_jpeg_encode_28', 'reso_960_encode_32', 'reso_960_encode_40', 'reso_1440_jpeg_encode_40', 'reso_960_encode_32', 'reso_640_jpeg_encode_36', 'reso_768_jpeg_encode_28', 'reso_1440_encode_40', 'reso_768_jpeg_encode_28', 'reso_640_jpeg', 'reso_960_jpeg_encode_40', 'reso_960_encode_36', 'reso_960_jpeg_encode_36', 'reso_1440_encode_40', 'reso_960_jpeg_encode_36', 'reso_960_encode_32', 'reso_960_encode_32', 'reso_320_jpeg_encode_40', 'reso_640_jpeg_encode_36', 'reso_640_jpeg_encode_36', 'reso_960_encode_36', 'reso_1440_encode_40', 'reso_960_encode_40', 'reso_768_jpeg_encode_32', 'reso_768_encode_28', 'reso_640_encode_24', 'reso_960_encode_40', 'reso_960_encode_40', 'reso_960_jpeg_encode_36', 'reso_1440_jpeg_encode_40', 'reso_960_encode_32', 'reso_1440_encode_40', 'reso_320_encode_16', 'reso_640_jpeg_encode_40', 'reso_320_encode_40', 'reso_320_jpeg_encode_36', 'reso_960_encode_40', 'reso_320_jpeg_encode_20', 'reso_320_encode_12', 'reso_320_jpeg_encode_40', 'reso_160_encode_16', 'reso_320_encode_16', 'reso_320_encode_16', 'reso_1440_encode_40', 'reso_320_encode_16', 'reso_320_encode_40', 'reso_640_jpeg_encode_28', 'reso_640_encode_28', 'reso_768_jpeg_encode_32', 'reso_1440_jpeg_encode_40', 'reso_640_jpeg_encode_24', 'reso_768_jpeg_encode_40', 'reso_960_encode_32', 'reso_960_encode_32', 'reso_960_encode_40', 'reso_640_jpeg_encode_40', 'reso_640_encode_24', 'reso_640_jpeg_encode_28', 'reso_640_jpeg_encode_36', 'reso_960_encode_32', 'reso_320_encode_40', 'reso_640_encode_36', 'reso_960_encode_40', 'reso_768_encode_28', 'reso_960_encode_32', 'reso_960_encode_40', 'reso_480_jpeg_encode_32', 'reso_960_encode_32', 'reso_640_jpeg_encode_36', 'reso_640_encode_36', 'reso_960_jpeg_encode_36', 'reso_960_encode_40', 'reso_960_encode_32', 'reso_320_jpeg_encode_40', 'reso_320_jpeg_encode_40', 'reso_1440_jpeg_encode_40', 'reso_320_encode_24', 'reso_960_jpeg_encode_36', 'reso_320_jpeg_encode_40', 'reso_640_jpeg_encode_36', 'reso_960_encode_32', 'reso_960_encode_40', 'reso_1440_jpeg_encode_40', 'reso_960_jpeg_encode_36', 'reso_960_encode_36', 'reso_960_encode_32', 'reso_640_encode_24', 'reso_320_jpeg_encode_40', 'reso_1440_jpeg_encode_40', 'reso_320_jpeg_encode_40', 'reso_960_encode_36', 'reso_960_encode_32', 'reso_1440_jpeg_encode_40', 'reso_960_encode_32', 'reso_640_jpeg', 'reso_640_encode_24', 'reso_640_encode_28', 'reso_768_encode_28', 'reso_960_encode_32', 'reso_768_encode_28', 'reso_640_encode_24', 'reso_768_jpeg_encode_28', 'reso_768_jpeg_encode_28', 'reso_640_encode_24', 'reso_640_jpeg_encode_28', 'reso_768_jpeg_encode_28', 'reso_640_encode_24', 'reso_960_encode_32', 'reso_960_encode_36', 'reso_768_encode_28', 'reso_960_encode_32', 'reso_640_jpeg', 'reso_960_encode_32', 'reso_960_encode_32', 'reso_480_encode_24', 'reso_960_encode_32', 'reso_640_jpeg_encode_36', 'reso_960_encode_36', 'reso_768_encode_28', 'reso_768_jpeg_encode_40', 'reso_640_encode_28', 'reso_320_jpeg_encode_40', 'reso_640_jpeg_encode_24', 'reso_960_jpeg_encode_32', 'reso_640_jpeg', 'reso_960_jpeg_encode_32', 'reso_1440_jpeg_encode_40', 'reso_160_encode_36', 'reso_768_encode_28', 'reso_640_jpeg', 'reso_640_jpeg', 'reso_640_jpeg', 'reso_320_jpeg_encode_40', 'reso_320_jpeg_encode_32', 'reso_960_jpeg_encode_32', 'reso_640_jpeg', 'reso_480_encode_40', 'reso_320_jpeg_encode_32', 'reso_640_encode_32', 'reso_320_encode_20', 'reso_160_encode_24', 'reso_160_jpeg_encode_36', 'reso_960_encode_32', 'reso_160_encode_32', 'reso_640_jpeg_encode_32', 'reso_320_jpeg_encode_32', 'reso_640_jpeg_encode_32', 'reso_640_jpeg_encode_28', 'reso_1440_jpeg_encode_40', 'reso_320_jpeg_encode_36', 'reso_960_encode_40', 'reso_160_encode_32', 'reso_640_jpeg_encode_32', 'reso_1440_jpeg_encode_40', 'reso_960_encode_36', 'reso_960_encode_36', 'reso_160_jpeg_encode_40', 'reso_160_jpeg_encode_20', 'reso_320_jpeg_encode_40', 'reso_160_jpeg', 'reso_1440_jpeg_encode_40', 'reso_960_jpeg_encode_40', 'reso_160_jpeg_encode_40', 'reso_320_encode_16', 'reso_960_jpeg_encode_32', 'reso_768_jpeg_encode_28', 'reso_320_encode_40', 'reso_320_jpeg_encode_40', 'reso_960_jpeg_encode_32', 'reso_960_encode_36', 'reso_1440_jpeg_encode_40', 'reso_320_encode_20', 'reso_640_jpeg_encode_36', 'reso_1440_encode_40', 'reso_480_encode_20', 'reso_1440_jpeg_encode_40', 'reso_960_encode_32', 'reso_160_encode_12', 'reso_1440_jpeg_encode_40', 'reso_1440_encode_40', 'reso_320_jpeg_encode_36', 'reso_160_jpeg_encode_40', 'reso_480_jpeg_encode_32', 'reso_160_jpeg_encode_32', 'reso_320_encode_12', 'reso_640_encode_32', 'reso_480_jpeg_encode_24', 'reso_640_encode_28', 'reso_768_jpeg_encode_32', 'reso_960_jpeg_encode_32', 'reso_160_jpeg_encode_36', 'reso_960_jpeg_encode_32', 'reso_160_jpeg_encode_40', 'reso_960_encode_36', 'reso_160_jpeg_encode_36', 'reso_1440_jpeg_encode_40', 'reso_640_encode_24', 'reso_960_encode_32', 'reso_640_jpeg_encode_32', 'reso_960_encode_32', 'reso_960_encode_32', 'reso_160_encode_32', 'reso_960_jpeg_encode_36', 'reso_960_jpeg_encode_36', 'reso_960_jpeg_encode_32', 'reso_960_encode_36', 'reso_768_jpeg_encode_36', 'reso_1440_encode_40', 'reso_320_encode_12', 'reso_960_encode_32', 'reso_768_jpeg_encode_28', 'reso_960_jpeg_encode_36', 'reso_160_jpeg_encode_40', 'reso_160_jpeg_encode_32', 'reso_960_jpeg_encode_32', 'reso_320_encode_40', 'reso_320_encode_20', 'reso_1440_encode_40', 'reso_160_jpeg_encode_36', 'reso_960_encode_32', 'reso_960_encode_36', 'reso_960_encode_32', 'reso_320_jpeg_encode_40', 'reso_160_encode_40', 'reso_160_jpeg_encode_40', 'reso_160_jpeg_encode_40', 'reso_640_jpeg_encode_36', 'reso_960_encode_32', 'reso_768_jpeg_encode_28', 'reso_768_jpeg_encode_28', 'reso_960_jpeg_encode_32', 'reso_960_encode_36', 'reso_320_encode_20', 'reso_960_encode_36', 'reso_1440_jpeg_encode_40', 'reso_320_jpeg_encode_40', 'reso_160_jpeg_encode_32', 'reso_160_jpeg_encode_36', 'reso_960_jpeg_encode_36', 'reso_960_encode_36', 'reso_320_encode_20', 'reso_160_encode_40', 'reso_320_encode_20', 'reso_1440_jpeg_encode_40', 'reso_160_jpeg_encode_36', 'reso_320_jpeg_encode_40', 'reso_960_jpeg_encode_36', 'reso_768_jpeg_encode_28', 'reso_160_encode_40', 'reso_768_jpeg_encode_28', 'reso_160_encode_40', 'reso_320_encode_40', 'reso_320_jpeg_encode_40', 'reso_320_jpeg_encode_40', 'reso_160_encode_40', 'reso_320_jpeg_encode_40', 'reso_160_jpeg_encode_32', 'reso_960_encode_32', 'reso_160_jpeg_encode_36', 'reso_160_encode_36', 'reso_160_jpeg_encode_28', 'reso_320_encode_40', 'reso_160_encode_40', 'reso_160_jpeg_encode_32', 'reso_160_jpeg_encode_36', 'reso_160_encode_40', 'reso_960_jpeg_encode_36', 'reso_160_jpeg_encode_36', 'reso_160_jpeg_encode_32', 'reso_960_encode_32', 'reso_160_jpeg_encode_40', 'reso_320_encode_40', 'reso_160_jpeg_encode_40', 'reso_160_encode_40', 'reso_160_encode_40', 'reso_160_jpeg_encode_40', 'reso_160_encode_32', 'reso_160_jpeg_encode_28', 'reso_160_jpeg_encode_36', 'reso_160_jpeg_encode_36', 'reso_160_jpeg_encode_32', 'reso_160_encode_40', 'reso_160_jpeg_encode_40', 'reso_960_jpeg_encode_36', 'reso_320_encode_40', 'reso_960_jpeg_encode_36', 'reso_640_jpeg_encode_32', 'reso_960_jpeg_encode_40', 'reso_1440_jpeg_encode_40', 'reso_320_encode_40', 'reso_160_jpeg_encode_36', 'reso_160_jpeg_encode_40', 'reso_160_jpeg_encode_40', 'reso_640_jpeg_encode_28', 'reso_960_jpeg_encode_36', 'reso_960_encode_40', 'reso_160_jpeg_encode_40', 'reso_768_jpeg_encode_28', 'reso_320_encode_40', 'reso_480_encode_20', 'reso_160_encode_32', 'reso_480_encode_20', 'reso_160_encode_40', 'reso_160_encode_40', 'reso_320_jpeg_encode_40', 'reso_640_encode_24', 'reso_160_jpeg_encode_40', 'reso_640_encode_24', 'reso_160_encode_40', 'reso_160_encode_40', 'reso_640_encode_24', 'reso_160_encode_40', 'reso_1440_jpeg_encode_40', 'reso_480_encode_20', 'reso_320_jpeg_encode_36', 'reso_160_jpeg_encode_40', 'reso_960_jpeg_encode_36', 'reso_320_jpeg_encode_40', 'reso_160_encode_36', 'reso_160_jpeg_encode_36', 'reso_768_jpeg_encode_28', 'reso_160_encode_40', 'reso_160_jpeg_encode_40', 'reso_320_encode_40', 'reso_320_jpeg_encode_40', 'reso_320_jpeg_encode_40', 'reso_480_jpeg_encode_20', 'reso_160_encode_40', 'reso_480_jpeg_encode_24', 'reso_640_encode_28', 'reso_480_jpeg_encode_24', 'reso_960_encode_32', 'reso_960_encode_32', 'reso_320_encode_32', 'reso_960_jpeg_encode_32', 'reso_320_jpeg_encode_40', 'reso_480_encode_24']


unique_best_config_list = list(np.unique(np.array(best_config_list_7)))
train_xlist, train_ylist, test_xlist, test_ylist = [], [], [], []
train_test_sep = 0.66
print("\n number of unique configurations/output labels = %d"%len(unique_best_config_list))

for i in range(1, int(train_test_sep*len(best_config_list_7))):
	train_xlist.append([contrast_7[i], colorfulness_7[i], brightness_7[i]])
	train_ylist.append(unique_best_config_list.index(best_config_list_7[i]))

for i in range(int(train_test_sep*len(best_config_list_7))+1, len(best_config_list_7)-1):
	test_xlist.append([contrast_7[i], colorfulness_7[i], brightness_7[i]])
	test_ylist.append(unique_best_config_list.index(best_config_list_7[i]))

train_xlist_np = np.asarray(train_xlist)
train_ylist_np = np.asarray(train_ylist)
test_xlist_np = np.asarray(test_xlist)
test_ylist_np = np.asarray(test_ylist)

print(train_xlist_np.size, train_ylist_np.size)
print(train_xlist_np.shape[0], train_xlist_np.shape[1])
#"""
"""
#for testing the model (working well)
train_xlist = np.random.random((1000, 20))
train_ylist = keras.utils.to_categorical(np.random.randint(10, size=(1000, 1)), num_classes=10)
test_xlist = np.random.random((100, 20))
test_ylist = keras.utils.to_categorical(np.random.randint(10, size=(100, 1)), num_classes=10)
"""
model = Sequential()
"""
def get_flops(model):
    run_meta = tf.RunMetadata()
    opts = tf.profiler.ProfileOptionBuilder.float_operation()

    # We use the Keras session graph in the call to the profiler.
    flops = tf.profiler.profile(graph=K.get_session().graph,
                                run_meta=run_meta, cmd='op', options=opts)

    return flops.total_float_ops  # Prints the "flops" of the model.
"""

"""
def count_flops(model):


    if not isinstance(model, (Sequential, Model)):
        raise TypeError(
            'Model is expected to be an instance of Sequential or Model, '
            'but got %s' % type(model))

    output_op_names = [_out_tensor.op.name for _out_tensor in model.outputs]
    sess = tf.keras.backend.get_session()
    frozen_graph_def = tf.graph_util.convert_variables_to_constants(
        sess, sess.graph.as_graph_def(), output_op_names)

    with tempfile.TemporaryDirectory() as tmpdir:
        graph_file = os.path.join(os.path.join(tmpdir, 'graph.pb'))
        with tf.gfile.GFile(graph_file, "wb") as f:
            f.write(frozen_graph_def.SerializeToString())

        with tf.gfile.GFile(graph_file, "rb") as f:
            graph_def = tf.GraphDef()
            graph_def.ParseFromString(f.read())

        with tf.Graph().as_default() as new_graph:
            tf.import_graph_def(graph_def, name='')
            tfprof_opts = tf.profiler.ProfileOptionBuilder.float_operation()
            flops = tf.profiler.profile(new_graph, options=tfprof_opts)
            writer = tf.summary.FileWriter('gg', graph=new_graph)
            writer.flush()

    return flops
"""

# define the keras model (globally/locally)
def classify(train_xlist, train_ylist, test_xlist, test_ylist, unique_best_config_list):
    #convert to numpy array
    train_xlist_np = np.asarray(train_xlist)
    train_ylist_np = np.asarray(train_ylist)
    test_xlist_np = np.asarray(test_xlist)
    test_ylist_np = np.asarray(test_ylist)
    print(train_xlist_np.size, train_ylist_np.size)
    print(train_xlist_np.shape[0], train_xlist_np.shape[1])
    
    model.add(Dense(32, input_dim=train_xlist_np.shape[1], activation='relu'))
    model.add(Dense(len(unique_best_config_list), activation='softmax'))
    
    # compile the keras model
    model.compile(loss='sparse_categorical_crossentropy', optimizer='rmsprop', metrics=['accuracy'])#categorical_crossentropy
    #with categorical_crossentropy as the loss function we need to convert the labels to one-hot encoding, otherwise it won't work
    # fit the keras model on the dataset
    print(model.summary())
    #print(count_flops(model))
    model.fit(train_xlist_np, train_ylist_np, epochs=10, batch_size=10)
    print("\n After fitting the model")
    #Predictions
    # make a prediction
    preds = model.predict_classes(test_xlist_np)
    # show the inputs and predicted outputs
    predicted_config_list = []
    for i in range(len(test_xlist_np)):
        print("X=%s, Actual index %s, Predicted index %s" % (test_xlist_np[i], test_ylist_np[i], preds[i]))
        print("=======Actual config %s, Predicted config %s" % (unique_best_config_list[test_ylist_np[i]], unique_best_config_list[preds[i]]))
        predicted_config_list.append(unique_best_config_list[test_ylist_np[i]])
    return predicted_config_list

def main():
   classify(train_xlist, train_ylist, test_xlist, test_ylist, unique_best_config_list)

if __name__ == "__main__":
	main()   