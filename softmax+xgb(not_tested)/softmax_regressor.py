import struct
import numpy
import array
import time
import scipy.sparse
import scipy.optimize

###########################################################################################
""" The Softmax Regression class """

class SoftmaxRegression(object):

    #######################################################################################
    """ Initialization of Regressor object """

    def __init__(self, input_size, num_classes, lamda):
    
        """ Initialize parameters of the Regressor object """
    
        self.input_size  = input_size  # input vector size
        self.num_classes = num_classes # number of classes
        self.lamda       = lamda       # weight decay parameter
        
        """ Randomly initialize the class weights """
        
        rand = numpy.random.RandomState(int(time.time()))
        
        self.theta = 0.005 * numpy.asarray(rand.normal(size = (num_classes*input_size, 1)))
    
    #######################################################################################
    """ Returns the groundtruth matrix for a set of labels """
        
    def getGroundTruth(self, labels):
    
        """ Prepare data needed to construct groundtruth matrix """
    
        labels = numpy.array(labels).flatten()
        data   = numpy.ones(len(labels))
        indptr = numpy.arange(len(labels)+1)
        
        """ Compute the groundtruth matrix and return """
        
        ground_truth = scipy.sparse.csr_matrix((data, labels, indptr))
        ground_truth = numpy.transpose(ground_truth.todense())
        
        return ground_truth
        
    #######################################################################################
    """ Returns the cost and gradient of 'theta' at a particular 'theta' """
        
    def softmaxCost(self, theta, input, labels):
    
        """ Compute the groundtruth matrix """
    
        ground_truth = self.getGroundTruth(labels)
        
        """ Reshape 'theta' for ease of computation """
        
        theta = theta.reshape(self.num_classes, self.input_size)
        
        """ Compute the class probabilities for each example """
        
        theta_x       = numpy.dot(theta, input)
        hypothesis    = numpy.exp(theta_x)      
        probabilities = hypothesis / numpy.sum(hypothesis, axis = 0)
        
        """ Compute the traditional cost term """
        
        cost_examples    = numpy.multiply(ground_truth, numpy.log(probabilities))
        traditional_cost = -(numpy.sum(cost_examples) / input.shape[1])
        
        """ Compute the weight decay term """
        
        theta_squared = numpy.multiply(theta, theta)
        weight_decay  = 0.5 * self.lamda * numpy.sum(theta_squared)
        
        """ Add both terms to get the cost """
        
        cost = traditional_cost + weight_decay
        
        """ Compute and unroll 'theta' gradient """
        
        theta_grad = -numpy.dot(ground_truth - probabilities, numpy.transpose(input))
        theta_grad = theta_grad / input.shape[1] + self.lamda * theta
        theta_grad = numpy.array(theta_grad)
        theta_grad = theta_grad.flatten()
        
        return [cost, theta_grad]
    
    #######################################################################################
    """ Returns predicted classes for a set of inputs """
            
    def softmaxPredict(self, theta, input):
    
        """ Reshape 'theta' for ease of computation """
    
        theta = theta.reshape(self.num_classes, self.input_size)
        
        """ Compute the class probabilities for each example """
        
        theta_x       = numpy.dot(theta, input)
        hypothesis    = numpy.exp(theta_x)      
        probabilities = hypothesis / numpy.sum(hypothesis, axis = 0)
        
        """ Give the predictions based on probability values """
        
        predictions = numpy.zeros((input.shape[1], 1))
        predictions[:, 0] = numpy.argmax(probabilities, axis = 0)
        
        return predictions



def executeSoftmaxRegression():
    
    """ Initialize parameters of the Regressor """
    
    input_size     = 568  # input vector size
    num_classes    = 72     # number of classes = number of best configurations
    lamda          = 0.0001 # weight decay parameter
    max_iterations = 100    # number of optimization iterations
    
    """ Load MNIST training images and labels """
    
    training_data   = [[23.919896640826874, 107.29025059795052, 0.6426116838487973], [26.79539641943734, 117.69417381685314, 0.5518394648829431], [26.064599483204134, 112.57060242247307, 0.6059113300492611], [24.16708229426434, 107.17449314594269, 0.6], [22.992424242424242, 98.26832237790194, 0.6644518272425249], [23.237373737373737, 93.98298803095399, 0.6733001658374793], [71.47647058823529, 361.07525020191633, 0.005590322530552665], [30.729166666666668, 122.91975420072646, 0.7086364484238016], [34.3187134502924, 135.93324033167264, 0.6703717841056569], [30.105413105413106, 121.03782270643318, 0.7151533602252835], [29.464673913043477, 115.2737187757763, 0.7308146942785649], [30.105849582172702, 118.9168273473898, 0.716636503277417], [30.75890410958904, 114.83475964821213, 0.7288047705470573], [36.617816091954026, 132.1456942443995, 0.6836498448967239], [23.962059620596207, 114.62182431860668, 0.7323119271605312], [32.16434540389972, 115.79457399222512, 0.7292662695121032], [33.266862170087975, 116.83581742785029, 0.7240662659609461], [30.624293785310734, 111.65140187359326, 0.7378386076423764], [34.306306306306304, 146.60053898405886, 0.6398413397972675], [32.44092219020173, 125.13050198798898, 0.7024648658114794], [26.760330578512395, 117.85241892606363, 0.7220423159025892], [35.916666666666664, 122.46996748710153, 0.7067194015734491], [34.08720930232558, 114.99081930373504, 0.728000231120356], [33.252252252252255, 131.45947397892635, 0.6816838679285684], [27.060439560439562, 124.46479511623528, 0.7025904099715945], [33.42424242424242, 117.94859745156572, 0.7187636599500838], [33.162534435261705, 123.58020851232446, 0.705692237598952], [25.21657754010695, 98.59665390839811, 0.7628454554524593], [31.346260387811633, 127.63160713395554, 0.6916729076290467], [36.78857142857143, 121.99465503454518, 0.7107250431828239], [24.018716577540108, 114.09947556465244, 0.7270225175762589], [29.439655172413794, 125.22217382808864, 0.6972407367591199], [22.79736842105263, 98.16906945992805, 0.7641133687370122], [32.076470588235296, 129.25522039296553, 0.6845704374529067], [34.713872832369944, 121.65955993264538, 0.7095031011620446], [31.781512605042018, 117.72439929414735, 0.7199736094776398], [29.31728045325779, 118.48459543588818, 0.7147647159970195], [33.37426900584796, 103.30194328082933, 0.7486555661001352], [31.07887323943662, 128.33107681250826, 0.687774419798141], [22.585164835164836, 116.25156833427725, 0.7199403281949279], [31.24561403508772, 119.89011304820043, 0.7121597974078447], [30.49570200573066, 120.18107007265269, 0.7115851741776927], [30.22478386167147, 108.51945741830126, 0.7384060976132935], [32.66763005780347, 130.86234459742982, 0.682106435855686], [34.320809248554916, 121.40349194096518, 0.7064224101118798], [25.759562841530055, 115.86433915617553, 0.7216786196122985], [31.20281690140845, 121.40476470008777, 0.7056983621474068], [27.066666666666666, 98.7908906037852, 0.7617024915901704], [33.04899135446686, 128.56887830778726, 0.6875053039517977], [31.094972067039105, 122.37895702655793, 0.7047183738360209], [28.76044568245125, 115.21974259391008, 0.724295290599623], [31.39142857142857, 119.62269759270468, 0.7098348401291942], [32.18005540166205, 115.8510114475454, 0.7192865548482228], [35.4364161849711, 134.29473192891268, 0.6729726644980882], [34.15895953757225, 124.90143270693059, 0.7022101589763474], [31.144475920679888, 124.0694435351753, 0.7042419653128686], [32.943502824858754, 144.57117474153358, 0.6411105413522818], [32.57541899441341, 113.89103992397523, 0.7281884670731527], [31.29014084507042, 129.47230590724683, 0.6878372829657438], [29.956873315363882, 123.18727344842218, 0.7061808927631195], [32.75218658892128, 118.54263668358112, 0.7165032082669512], [29.949295774647887, 119.63657199198808, 0.7118739938215203], [22.930555555555557, 104.58114111401305, 0.7494692761799517], [33.07826086956522, 135.06361019426274, 0.6719281378696781], [27.601671309192202, 124.88089102227423, 0.7006070324132402], [35.31043956043956, 118.03432500132082, 0.7179232661516551], [31.638968481375358, 119.11692274268836, 0.7116271740064755], [23.673972602739727, 109.41370054213141, 0.7358406826251288], [32.33806818181818, 137.24163443897473, 0.6663941245660843], [26.018617021276597, 115.76834855114262, 0.7219443888777756], [33.36752136752137, 122.0236283661212, 0.7082421590080233], [27.292225201072387, 122.07310516125814, 0.7044115759295974], [32.38953488372093, 108.66468782341273, 0.7381645978331062], [30.60220994475138, 126.39837618655531, 0.6928254004543961], [26.844192634560905, 119.84371211765686, 0.7139923310019962], [30.169444444444444, 123.87914068592349, 0.7042670653861637], [33.325905292479106, 126.89125496164571, 0.6932277216336271], [30.22222222222222, 103.5451956361355, 0.7509325096165054], [30.170731707317074, 122.32642049444965, 0.7025127953040511], [31.55263157894737, 122.26789734214152, 0.7097939582629639], [29.476712328767125, 122.88156791953455, 0.7058037026153394], [29.195530726256983, 132.6600882419149, 0.6775020751808372], [27.148247978436657, 109.34215095506232, 0.735975864746998], [29.997326203208555, 119.11019330026731, 0.709542770023239], [31.52112676056338, 131.21497690936877, 0.6805741484456344], [27.980716253443525, 122.9150523649508, 0.6994938688781006], [34.191428571428574, 129.18351376700602, 0.68221565817565], [24.872093023255815, 104.8614518191202, 0.7429431912129444], [28.47222222222222, 120.19123484993352, 0.702716473534036], [29.09917355371901, 130.57995776712704, 0.6800432729558645], [25.865951742627345, 118.54297627527225, 0.7113086605951622], [28.843575418994412, 126.95326192651068, 0.6872826447712088], [33.70247933884298, 109.84381054065086, 0.7321256813081116], [30.49142857142857, 124.79562332488061, 0.691088002750086], [33.04213483146067, 127.99575642851526, 0.6899805148189929], [27.101156069364162, 122.46676797304586, 0.7022222222222222], [32.02564102564103, 127.75575797530945, 0.6858921649242335], [24.744, 107.19842594843443, 0.7378236653433667], [27.18351063829787, 113.88545499225926, 0.7194111554963752], [31.89830508474576, 132.98392725147968, 0.6751226264632422], [27.43089430894309, 122.98959187894545, 0.7036172873394944], [31.380165289256198, 131.2366166426042, 0.6776710406611877], [31.03542234332425, 112.51180010123214, 0.7252735331494281], [28.927777777777777, 119.22096666079513, 0.7057644811034997], [31.24376731301939, 125.53269586480695, 0.6968675842429995], [31.276243093922652, 126.12596935450556, 0.6933901918976546], [33.73391812865497, 159.13042958978943, 0.5893427230046948], [28.95762711864407, 121.65718182164522, 0.7040904163744182], [28.07967032967033, 128.15881698872582, 0.6827582935391038], [33.521126760563384, 134.20350333211803, 0.6731665892230536], [35.67908309455587, 175.36276967748742, 0.5239311511680874], [31.793296089385475, 124.39023984792833, 0.6966372255084677], [29.880681818181817, 128.24460681037016, 0.6819728431964893], [26.03867403314917, 114.93497012401261, 0.7189671033848302], [31.337047353760447, 126.8207369483886, 0.6920460657449299], [24.763779527559056, 109.69974474254064, 0.7374637772458108], [28.166197183098593, 128.34271254210338, 0.6908843408202352], [28.427419354838708, 124.03009938168478, 0.6976475247524753], [26.349333333333334, 118.18276263867254, 0.7127393705926363], [31.238095238095237, 133.23625172938424, 0.6740900383141762], [27.73015873015873, 112.79314500566431, 0.7281354315689079], [31.515492957746478, 129.68145933534294, 0.6872191434968322], [28.133522727272727, 127.36747322054056, 0.689674256799494], [29.025280898876403, 116.27225116729261, 0.7169942708827904], [29.910112359550563, 127.86037505026644, 0.689839825608947], [25.865591397849464, 108.72769010698393, 0.7413212291828117], [28.46067415730337, 127.64720775145376, 0.6916989179369718], [24.60217983651226, 122.64330214830233, 0.7000909718301023], [27.58005249343832, 117.03623460829962, 0.717584003298289], [29.337950138504155, 129.61048859231073, 0.6860677186583142], [25.72, 111.73156221382679, 0.733283603409145], [29.825352112676057, 132.10560796665234, 0.6826856822370002], [28.432876712328767, 128.67693965559548, 0.6852217777563577], [26.59078590785908, 112.66842195018363, 0.7263217370247801], [29.46927374301676, 127.14489274154217, 0.6913544295606031], [23.91292875989446, 107.20275012621184, 0.7420955644639855], [33.25284090909091, 131.22435127347472, 0.6818795000568856], [25.572580645161292, 125.3327278784556, 0.6948034862687058], [27.43646408839779, 115.95540599495293, 0.7166062291987482], [27.791891891891893, 128.55724221473554, 0.6876421404682275], [22.771428571428572, 104.8582399324979, 0.7471020544513112], [31.965417867435157, 129.34432774816014, 0.6868580940491053], [23.602666666666668, 123.98827022011687, 0.6976141166169958], [28.772486772486772, 121.95902492582564, 0.702161307327359], [23.488126649076516, 129.0179083672461, 0.6845554890048772], [27.84426229508197, 108.1877889351745, 0.7382471141513467], [28.04289544235925, 130.34426094257597, 0.6811071817192601], [25.925925925925927, 125.83050719310813, 0.6918204445970303], [22.869017632241814, 113.27073218081942, 0.7225666085334899], [29.537837837837838, 129.40488768077526, 0.6833035729764402], [30.03846153846154, 116.38712353845352, 0.7193167476357601], [27.57591623036649, 127.78315762664278, 0.6894732289594325], [33.908587257617725, 129.12234574775601, 0.6810161823560118], [20.911167512690355, 113.26025008031122, 0.7211752147969273], [30.029490616621985, 128.3618345220733, 0.6875099162626708], [26.25263157894737, 109.35856653973588, 0.7340392074640948], [34.283378746594, 132.11416358956507, 0.6789212658183166], [31.47138964577657, 122.18001938710557, 0.6994871066782615], [25.11382113821138, 119.3130803703827, 0.7068085182088277], [33.389830508474574, 163.40860604289082, 0.583170604991132], [31.83288409703504, 120.43246666903104, 0.708331830477908], [30.818428184281842, 137.22996835510153, 0.6631147540983606], [25.900537634408604, 123.98743602609031, 0.6933031971127557], [20.73551637279597, 115.49332110838121, 0.728295622233153], [20.470149253731343, 124.04457485261506, 0.7053505985829465], [20.645569620253166, 126.61517641315211, 0.6915781259379314], [21.118110236220474, 122.35605104642144, 0.7087161366313309], [22.383631713554987, 128.2762019516468, 0.6960467807760249], [22.075757575757574, 128.00498676688488, 0.6917041030248577], [21.195822454308093, 125.61919594375418, 0.7049394221808015], [19.54381443298969, 124.91562473671748, 0.6979833353459727], [22.054123711340207, 130.45375088471624, 0.694251260128884], [22.93041237113402, 127.06887366832831, 0.6901968088408766], [22.313471502590673, 124.0054810459108, 0.7122105930859499], [21.880299251870323, 118.90054592128028, 0.7174893510398397], [22.056265984654733, 119.34514463254342, 0.7214235957190804], [22.55128205128205, 125.75300672238401, 0.7000688920899355], [21.65491183879093, 125.73508555610059, 0.7067031986746527], [21.890274314214462, 128.721681671084, 0.6870091011095874], [23.02857142857143, 127.75894185200929, 0.6996947341643348], [23.6793893129771, 130.1477539158289, 0.6889450410612761], [23.207070707070706, 122.23198124544332, 0.7166611679313758], [23.873684210526317, 139.80556513229675, 0.6604934053167498], [21.768637532133678, 126.06048573097998, 0.6893959377472962], [24.60969387755102, 142.08139121144578, 0.6555200222469411], [23.04639175257732, 131.66607215059264, 0.6712392933618844], [23.5012853470437, 128.378715664535, 0.689297727740784], [22.766404199475065, 117.35010832759596, 0.7172579354494532], [24.79373368146214, 133.0007576863449, 0.6788407000069171], [23.11917098445596, 124.98920547431297, 0.6927059135859827], [24.09585492227979, 134.8596719230706, 0.6781997380935971], [23.157068062827225, 129.56744176372936, 0.6799867461895295], [23.710594315245476, 140.5237560733064, 0.6551254089422028], [24.212435233160623, 129.27510499451066, 0.6800105520015828], [23.833759590792837, 139.54800369888125, 0.6619253762110905], [20.77329974811083, 125.35887109611855, 0.695059511935634], [22.831202046035806, 136.77875493765208, 0.674187725631769], [22.04102564102564, 129.91620732840082, 0.6834026008848371], [22.463104325699746, 118.88888845046118, 0.7235938243895803], [21.70886075949367, 128.1749194747753, 0.694682320441989], [22.19280205655527, 131.4947027722336, 0.675160076572711], [21.845771144278608, 139.15470317606065, 0.6575852984643064], [21.426020408163264, 140.33415607251607, 0.6602530654839551], [20.5, 124.97441117407293, 0.6959929212488939], [22.493573264781492, 139.83235935631984, 0.6625180138870693], [21.503896103896103, 133.02864389865286, 0.6706448387903025], [23.446475195822455, 144.54220405265283, 0.6457929430011632], [24.083544303797467, 127.0816587324611, 0.6909203980099502], [24.206982543640898, 139.9155188936966, 0.6622190088076771], [22.854545454545455, 139.1779629670692, 0.6549471661863593], [21.9556135770235, 119.61908542952835, 0.7128208315207258], [22.79123711340206, 127.7623518171486, 0.6916238888193315], [25.23846153846154, 131.92596610836637, 0.6780726679160873], [23.06824146981627, 139.90337098205117, 0.6599432519121639], [24.62962962962963, 136.0208722669374, 0.6659028145014396], [24.466836734693878, 143.39848139667433, 0.6438759872686549], [22.879895561357703, 128.80743576197142, 0.6945026787794083], [23.800511508951406, 132.56876855303273, 0.6863704145541306], [25.380102040816325, 140.41128594950493, 0.6554302807179015], [25.105670103092784, 134.23279962889498, 0.682618294647652], [25.124352331606218, 156.94254667165984, 0.5918901987584715], [24.335064935064935, 136.70791295844552, 0.6644211007079242], [25.631720430107528, 134.97024578490527, 0.671064450931956], [26.068421052631578, 134.84056179998663, 0.674677373100086], [27.25581395348837, 148.28775680801212, 0.6262711388280241], [25.235135135135135, 131.5685862008272, 0.6764146328205686], [26.241469816272964, 143.1969811805158, 0.6508594143664969], [25.806122448979593, 134.59561785517042, 0.6709547847798947], [28.6747311827957, 154.5186440045776, 0.6073646850044365], [25.584656084656086, 125.6576016800809, 0.696836268754077], [25.251928020565554, 131.01563446606752, 0.6864271000228885], [27.35958005249344, 163.75634325771185, 0.5663583566358357], [24.604113110539846, 118.73517070202222, 0.7181662014172214], [25.302083333333332, 129.9421066276356, 0.6916840144625835], [24.79002624671916, 140.27351851347723, 0.6562029671038486], [25.927835051546392, 131.22982219771467, 0.6908657312406411], [26.87272727272727, 140.28582352745366, 0.6612467681700661], [26.5, 143.6185952252973, 0.6390912055658223], [27.50134770889488, 146.3301625304258, 0.6407952375603729], [24.332467532467533, 137.2723077909861, 0.6595515308322553], [24.59946949602122, 148.60644859977594, 0.6307334109429569], [26.669354838709676, 138.01026591292484, 0.6515842134519177], [24.093333333333334, 133.49327689366956, 0.6776194467728416], [24.724137931034484, 127.76047519289806, 0.6884229815673171], [26.875661375661377, 131.96217872156265, 0.6830482788482356], [25.683195592286502, 143.79601681276745, 0.6396985713538124], [27.57963446475196, 136.4693637318418, 0.6699070612114091], [25.53475935828877, 148.39562880795503, 0.62660485021398], [25.894021739130434, 131.04530250098807, 0.6902188381875299], [26.91755319148936, 142.1402562704564, 0.6561698411832123], [26.719346049046322, 141.55501722000065, 0.6450581700031444], [26.766129032258064, 137.1105605879635, 0.6696271929824561], [27.968586387434556, 141.65767587527884, 0.6518987341772152], [24.470588235294116, 128.75692092130743, 0.6819596479931316], [27.305405405405406, 142.04492848259687, 0.6512203166226913], [25.647849462365592, 122.45861511156684, 0.705359991492077], [29.682926829268293, 132.97891063813887, 0.681271663778163], [27.455525606469003, 129.4161758448332, 0.6842435327933107], [29.00275482093664, 143.33990057528112, 0.646309479205695], [27.54255319148936, 130.94833489505757, 0.6884069359316884], [29.518716577540108, 140.46571238276786, 0.6596597681222234], [28.376021798365123, 136.74221381970372, 0.6615352610775952], [29.039787798408486, 142.2139254961828, 0.6577008928571428], [27.162983425414364, 135.8927951501809, 0.6642698816024221], [30.715877437325904, 145.93330572082363, 0.6434291640260413], [29.91780821917808, 129.67494252503516, 0.678577373356267], [32.141666666666666, 145.79496932256816, 0.6431641305610408], [27.474114441416894, 123.98672291677374, 0.6949257425742574], [26.72222222222222, 128.3141206395453, 0.6896154731752245], [29.41687979539642, 133.28676117759218, 0.677491853017193], [29.649717514124294, 138.73879736561258, 0.659846694715002], [30.54471544715447, 136.0196317162738, 0.6673036928784217], [32.0989010989011, 144.6666547754218, 0.6378134750953427], [29.59776536312849, 136.99603420101315, 0.6620931007665815], [31.985915492957748, 134.71318815394812, 0.6752141767398193], [32.73972602739726, 153.4639424021804, 0.6035417628057222], [31.524193548387096, 141.97963112436304, 0.6562715260817834], [30.37431693989071, 128.72608867857065, 0.6786847242557345], [30.84180790960452, 142.61050904091167, 0.6516377397885945], [30.672922252010725, 127.50267420247735, 0.6815070643642073], [29.562666666666665, 124.04888245910483, 0.7021469218830833], [31.137096774193548, 136.77161970289598, 0.6620693998362617], [30.37735849056604, 133.50097701585867, 0.6793456838785967], [29.435135135135134, 141.7425306659748, 0.6419285624132273], [30.37465564738292, 141.28843501534342, 0.6517053295656174], [31.06648936170213, 137.85029644037553, 0.6531160234794555], [30.91643454038997, 146.48062440267873, 0.635624634193926], [29.408602150537636, 135.26606899269308, 0.6629882751269672], [29.779329608938546, 155.92930586304985, 0.6043877351734913], [30.738666666666667, 126.58963211089582, 0.6878753753753754], [31.51212938005391, 147.7066658700191, 0.6308180993128485], [28.563186813186814, 120.57935513103669, 0.7054141133362815], [29.413333333333334, 128.53551103842173, 0.6890090786169596], [29.406735751295336, 139.06550483654792, 0.6544834005584859], [29.669398907103826, 137.63769307089635, 0.6640352012423968], [29.50943396226415, 139.6866903623178, 0.6469891534721356], [31.520891364902507, 139.2422287767813, 0.6586720690105868], [30.913978494623656, 140.22942813533857, 0.651271373588239], [31.80851063829787, 145.13108196613751, 0.645421540943929], [29.597883597883598, 134.62207380476704, 0.6616957541026309], [32.02197802197802, 149.80315038791883, 0.6238632478632479], [28.958549222797927, 124.79580866786162, 0.6961061708434384], [29.333333333333332, 147.72518461817268, 0.6271422599972133], [28.01578947368421, 120.85487268498036, 0.7027943570265871], [29.603217158176943, 131.42195488420325, 0.6764159383387242], [29.46301369863014, 145.93829572539872, 0.627181141765984], [30.49041095890411, 146.4021790601886, 0.63108153078203], [30.370165745856355, 139.97211908305712, 0.6460069996818326], [30.76243093922652, 144.5822158335028, 0.6413093897024716], [31.757255936675463, 140.3776914610146, 0.6462845824547953], [32.98870056497175, 151.5159762248731, 0.6164044191496485], [33.16712328767123, 145.28233072226263, 0.625757291861845], [32.444759206798864, 150.8457797041563, 0.6216288384512684], [31.70056497175141, 144.8484659411705, 0.6372121130732559], [31.994475138121548, 128.473520910938, 0.6765132533298167], [32.43131868131868, 135.4324335411904, 0.6686266558529332], [31.502717391304348, 131.97128597642492, 0.6803769172570328], [32.71508379888268, 139.58686876695802, 0.6462956865327626], [34.21511627906977, 159.30073577433075, 0.5808001052770101], [32.39664804469274, 132.7876862399778, 0.6699606019505264], [35.90555555555556, 149.91590723076106, 0.6217385603776059], [30.83423913043478, 140.32896499575327, 0.6484753222257151], [31.56896551724138, 151.420557354536, 0.6211678832116788], [30.521978021978022, 138.0535666553498, 0.651285930408472], [33.93201133144476, 156.47994084184094, 0.6057621440536013], [32.34574468085106, 132.2133359871631, 0.6685655100983946], [32.286908077994426, 151.2531435007599, 0.6199419036681754], [31.46814404432133, 125.41743612363237, 0.6887761823211698], [30.89544235924933, 122.41976122970115, 0.7053847186786626], [32.48066298342541, 142.60328180706236, 0.6460499662390277], [33.18598382749326, 140.78675509803784, 0.6466244725738397], [31.656338028169014, 138.14845942395513, 0.6548168249660787], [33.66946778711485, 147.24999626456756, 0.63239092495637], [33.13068181818182, 139.02736011673983, 0.6502797761790567], [32.811797752808985, 146.30421387380304, 0.6377158970743744], [20.09045226130653, 92.68401041831329, 0.8215345969399406], [22.72, 118.87961268326146, 0.7611224137269202], [22.095823095823096, 105.77324758910927, 0.7857546210894854], [20.9064039408867, 107.55283784271313, 0.7889080130043985], [20.43867924528302, 94.85200221003001, 0.8114244560685315], [19.873508353221958, 100.25102437325887, 0.8043886186956688], [19.26252983293556, 97.17104746492578, 0.8018058690744921], [21.64851485148515, 115.09325757477336, 0.768989999236583], [21.948655256723715, 101.67727280474024, 0.7973182247403211], [19.822660098522167, 112.89629470731798, 0.7734737795899875], [20.346437346437348, 106.88411000772739, 0.78206962327134], [21.192592592592593, 113.17498308079615, 0.774404432132964], [18.67548076923077, 100.10888354751093, 0.7992153158716896], [21.289537712895378, 111.07717067001535, 0.7764832793959008], [16.847826086956523, 96.55997437994085, 0.805393226783074], [19.0316301703163, 106.73498251955226, 0.7883961462170587], [18.722748815165875, 94.37435432282777, 0.8140949451164091], [19.348557692307693, 94.49577898259466, 0.8178323281486968], [21.32345679012346, 96.48952438724062, 0.8074915028557412], [18.5669099756691, 108.20836011024112, 0.7880551733869545], [18.280575539568346, 99.86851579544269, 0.8024036265242296], [20.297619047619047, 108.85161858444076, 0.7859265548715771], [19.766584766584767, 113.55775262360063, 0.7705969583060317], [21.83170731707317, 111.38256285845223, 0.7760490661492082], [18.39328537170264, 99.37979045114331, 0.8027985458536251], [18.65011820330969, 114.98977941844898, 0.7674957410562181], [19.93719806763285, 126.06294715845789, 0.7231808665863098], [16.15566037735849, 98.5864825814715, 0.8061643182035052], [18.87378640776699, 95.70139289281173, 0.8092983618975476], [16.58139534883721, 96.66381096076654, 0.8075450379762726], [20.315403422982886, 110.81672346532042, 0.7735490592633449], [16.531764705882352, 92.99217705267115, 0.8208728063363876], [17.37440758293839, 97.70363257875836, 0.8045741854713121], [19.506053268765132, 115.68304811189246, 0.7649936197362824], [17.46359223300971, 97.66834988664752, 0.8023079439669274], [19.34140435835351, 104.20779737973984, 0.7959517109921032], [19.69138755980861, 98.83523896388778, 0.8027794561933534], [20.788834951456312, 113.06057879251136, 0.7745627689771999], [19.214285714285715, 95.22561801790987, 0.8085739177456664], [19.095693779904305, 110.9400863041168, 0.7802201133917472], [18.714634146341464, 106.35608205879616, 0.7851911396927475], [19.277227722772277, 107.26146680767151, 0.7850707082761501], [17.759036144578314, 101.83814163822186, 0.7916093333723687], [20.35786802030457, 112.88656089385171, 0.7744021835874918], [19.639506172839507, 101.11160430621331, 0.795597945707997], [19.584158415841586, 109.10003521255031, 0.7822801995100788], [21.490291262135923, 109.01337032270375, 0.774061218049858], [18.47772277227723, 111.83130974217343, 0.7781260986757296], [16.705314009661837, 88.20798634952453, 0.8235892369384553], [19.263027295285358, 100.23978947008767, 0.7999305213791507], [18.72235294117647, 93.04290895521613, 0.8146571693305537], [22.734015345268542, 114.7486440631207, 0.7690058479532164], [21.78855721393035, 114.80940734259752, 0.7659978387219253], [19.17258883248731, 103.23616088129174, 0.7964593897340094], [19.017114914425427, 93.38456084314612, 0.8095848506919155], [17.54830917874396, 104.81567258433144, 0.7945709958124202], [19.051344743276285, 102.79698688486047, 0.7923505275498242], [18.703883495145632, 106.93584074089512, 0.7857416296121794], [17.766265060240965, 93.26491997043907, 0.8105269249688938], [19.577565632458235, 103.19369946455174, 0.7968113478502975], [20.51207729468599, 98.97447893642924, 0.8022237098698956], [18.02386634844869, 91.07416010132512, 0.8222861504139024], [20.946601941747574, 102.324918124019, 0.7918598957283175], [20.90274314214464, 106.87296377348777, 0.7903600293901543], [20.86783042394015, 104.06954326938579, 0.7925162119530291], [20.465822784810126, 109.16261431064176, 0.7838328521682193], [19.327543424317618, 97.4806296560286, 0.8029415211531701], [21.59124087591241, 111.31573941199494, 0.7786131496180919], [20.562043795620436, 100.9321714615834, 0.7981109097929724], [21.761194029850746, 114.15322509970389, 0.7691233283803863], [19.64963503649635, 101.8117814637985, 0.7910456484890993], [21.79145728643216, 113.76891333867131, 0.7696433834364869], [18.548872180451127, 102.79661625486, 0.7906482155863074], [20.03960396039604, 100.5957463878446, 0.7989109751456425], [19.441747572815533, 95.36438091655188, 0.80420870567887], [19.752525252525253, 111.30787494933374, 0.7774554617909049], [19.815533980582526, 95.48884981829285, 0.8083399221060646], [19.2975, 107.50572047038439, 0.7843700065100314], [21.659367396593673, 105.44515556244788, 0.7819849006392641], [22.61712846347607, 109.21889685065767, 0.7811854300726135], [20.58354114713217, 99.24152200997482, 0.798200290275762], [18.22596153846154, 105.4534334295605, 0.7889301699675277], [22.379746835443036, 120.991648459826, 0.7414707467173365], [18.87621359223301, 102.40896659166243, 0.7947677430495597], [18.935560859188545, 101.74322139500833, 0.7951529959939767], [18.10411622276029, 99.53281047411606, 0.8021180288666837], [19.097087378640776, 94.98024706139935, 0.8062544020284547], [19.42548076923077, 106.8828251013008, 0.787218901224025], [18.537128712871286, 99.25910110379972, 0.799790712144352], [20.781326781326783, 108.35645321279533, 0.7855246450421333], [20.54040404040404, 102.3142687138245, 0.7890061865032068], [21.05665024630542, 110.32849943921919, 0.7806974102018819], [21.046683046683047, 102.75033436350049, 0.7902043854124922], [23.621287128712872, 110.37916431193449, 0.7778717201166181], [22.475490196078432, 100.34344968232264, 0.7892028655901752], [20.007125890736344, 109.46221375645428, 0.7775129920468575], [19.825, 103.82814359778028, 0.7895970277222063], [19.997524752475247, 98.77804744200178, 0.8034663835404172], [19.78102189781022, 99.42271402860908, 0.7976735587725037], [21.73551637279597, 113.0673143352928, 0.7692263412387751], [21.61, 101.99754065856992, 0.7933725983531564], [21.309756097560975, 114.14369058799755, 0.7727984230969911], [22.01005025125628, 100.53597884069487, 0.7934615603482615], [21.47314578005115, 107.38368104134932, 0.7879942968545407], [19.300492610837438, 105.37965613661744, 0.7834633205744381], [18.718987341772152, 108.38828666608046, 0.7836192905170415], [18.04884318766067, 102.01540883207373, 0.7902289033139733], [21.358247422680414, 109.22474653109093, 0.7813181382097276], [21.542929292929294, 103.66367515623467, 0.7878144022051223], [21.849872773536894, 98.75859969691619, 0.8008179252347215], [19.902255639097746, 99.97858122615085, 0.7953736147907586], [19.844444444444445, 106.19126498014468, 0.7882099877914075], [21.0875, 107.96386074569618, 0.7806440393032086], [22.064837905236907, 108.73551419687522, 0.7831432117737455], [21.0, 104.06549332729914, 0.7848457587277634], [24.462915601023017, 111.26972858824878, 0.7764185397428665], [23.06801007556675, 103.86041361844758, 0.7852600732600733], [24.250632911392405, 115.36572243024328, 0.7632793438960581], [19.883495145631066, 101.81633676101654, 0.7858873151129984], [20.33915211970075, 109.93740828032317, 0.777179236043095], [23.632653061224488, 102.86736555421346, 0.7895485854158365], [23.025125628140703, 98.42667900078608, 0.8008059215226773], [18.362244897959183, 97.98668128617855, 0.7987815197156879], [23.040506329113924, 106.57601761742374, 0.7875129058162211], [21.159313725490197, 100.73913244345006, 0.7926391128461908], [22.16876574307305, 110.49684554593237, 0.777643539293522], [23.46875, 103.85340245959229, 0.7853813800159145], [24.7375, 117.38716345728167, 0.7582166415924083], [19.429280397022332, 103.61069681947781, 0.7873571449030448], [20.632754342431763, 111.93288072566324, 0.771207260325443], [17.348780487804877, 104.85293334638239, 0.7766243968129278], [22.26817042606516, 109.94869411901972, 0.7786107231422627], [20.870098039215687, 103.54415889582391, 0.7869028448738594], [24.806122448979593, 100.28117510876571, 0.7956661636151371], [20.729528535980148, 96.54042440391436, 0.7982210785410606], [23.108040201005025, 104.42894612574308, 0.7890600618492354], [20.83211678832117, 103.85151646010588, 0.7887847310193395], [22.283251231527093, 105.65147495970308, 0.7872619081513538], [23.4925, 106.54659239673967, 0.7780374481818435], [23.2725, 109.98661484408613, 0.7787252245829175], [19.948453608247423, 124.51454158177265, 0.7087090301003345], [24.698453608247423, 152.6509461372865, 0.6316229715842554], [21.675, 106.83888307244142, 0.7689329338557271], [24.28125, 147.33491496504683, 0.6499968976856735], [20.97506234413965, 112.2870995439967, 0.743131101141768], [21.06282722513089, 144.2417733087173, 0.6580145244796552], [20.289473684210527, 97.37316523704509, 0.7894329463234057], [19.143203883495147, 124.39054929346133, 0.7254188730263476], [16.452380952380953, 96.06747262489779, 0.7931125376003969], [14.391402714932127, 100.91608460400971, 0.7881691251155951], [14.691943127962086, 96.01115873520553, 0.798338447720979], [25.719887955182074, 146.98088604918584, 0.6533278833708018], [25.273972602739725, 110.45452443105168, 0.7558575749315264], [20.241293532338307, 119.68865970039026, 0.7336138312792444], [13.585882352941177, 93.5443291524377, 0.7974954407294833], [18.61369193154034, 131.2321766418893, 0.7024776181553196], [12.915094339622641, 89.80111890968128, 0.8032341672301104], [19.8, 135.26922941497537, 0.6923143025941243], [19.785185185185185, 112.56182879672072, 0.7488170184750854], [14.184466019417476, 101.75869813213993, 0.7847293365569807], [8.155056179775281, 77.01022323174122, 0.8341308623451408], [17.88697788697789, 115.62203860261236, 0.750639003155078], [17.86904761904762, 109.04253850419182, 0.7609400324149108], [11.255555555555556, 89.55253466774789, 0.8115520403936806], [15.653579676674365, 98.89692746050112, 0.7865135654566208], [15.023866348448687, 113.18590062188615, 0.7568482490272374], [13.683720930232559, 101.90987649132673, 0.7818160638359835], [11.202702702702704, 94.60343311783734, 0.7992241017071717], [16.13679245283019, 99.79215301956829, 0.7807533644417394], [10.460674157303371, 102.19582247648589, 0.7787996882307093], [15.66046511627907, 100.41755456868663, 0.7818469952747689], [7.5978260869565215, 83.8641171069757, 0.8214990425645662], [9.675615212527964, 83.83310343695165, 0.8169725430063731], [19.17079207920792, 107.30936620378249, 0.771932524187809], [7.576419213973799, 87.36613993589258, 0.8143790849673203], [15.590909090909092, 104.50461950652692, 0.7770234330422336], [16.692493946731236, 101.66930687609566, 0.7783932459792948], [8.629139072847682, 98.58386903289214, 0.7920654101779484], [17.473300970873787, 108.12533227792493, 0.7652187421114973], [20.139303482587064, 111.61103521332782, 0.7598274023077669], [10.652272727272727, 85.94024441038036, 0.8113389833751028], [12.293706293706293, 105.96470123846524, 0.7721758173608015], [16.52403846153846, 102.46172096792287, 0.7779812818840858], [13.676814988290397, 99.90572594701851, 0.7856312619475317], [13.223255813953488, 94.28645907162544, 0.793466239401072], [14.913551401869158, 97.00358027941203, 0.7951258474616563], [10.771689497716896, 96.95827853498506, 0.7934052165989597], [15.619718309859154, 104.45674222135463, 0.779525755088014], [13.6270783847981, 101.75047085991307, 0.7806262157007158], [10.728285077951002, 98.48893559183769, 0.7908728867104482], [19.65450121654501, 106.7138241616553, 0.7697956760690143], [8.319290465631928, 92.98843431072082, 0.8023766294898028], [11.164759725400458, 100.75959008824087, 0.7729332250939228], [11.861431870669746, 105.94142449842995, 0.7735382847292056], [15.43155452436195, 99.68987086021808, 0.783388179794944], [17.577102803738317, 101.55577670134096, 0.7821649848685907], [9.707865168539326, 87.83311895789699, 0.8065536532252009], [16.25358851674641, 97.56938374299799, 0.7916367823034238], [7.8841870824053455, 89.72326300046409, 0.8057270930463483], [13.004524886877828, 95.54514980409235, 0.7953136292746016], [14.55841121495327, 108.98036452471382, 0.7574183355792017], [13.47906976744186, 100.66741467519357, 0.7854679192789222], [11.77345537757437, 101.19912971135254, 0.7789748674726364], [15.710588235294118, 106.96859027541933, 0.7682731808214194], [16.82547169811321, 106.22015352385918, 0.7647468998530021], [14.35909090909091, 109.50771659822615, 0.7633120109602787], [9.99554565701559, 95.04719909815574, 0.7903063165905632], [12.91686460807601, 97.85265557609824, 0.7873426728075151], [8.964912280701755, 89.76041965805861, 0.796558267110034], [15.262295081967213, 95.34524772386781, 0.7957775919732442], [13.417249417249417, 99.40592870906606, 0.7851242031844039], [12.248291571753986, 99.1721978529044, 0.7862931167231291], [10.59954233409611, 98.24822011382697, 0.7792410882508102], [10.391402714932127, 99.73477067523316, 0.7831867875345291], [12.28246013667426, 95.70509618785258, 0.7900083441678148], [17.159523809523808, 104.65523241569083, 0.7707658062248604], [16.65, 107.46611953676707, 0.7564422277639236], [12.009216589861751, 103.67401829766521, 0.7754948069762885], [14.549397590361446, 104.92060959352071, 0.7682341093078204], [16.497596153846153, 97.36113101415368, 0.7894175545706262], [13.19626168224299, 98.1072711697405, 0.7811075858090568], [12.972093023255814, 89.10845725648726, 0.8103763279747117], [11.652272727272727, 101.90725924669171, 0.7755044102242802], [14.536130536130536, 104.44299398514984, 0.7774250888776029], [13.469047619047618, 138.51873141745838, 0.6841808294339109], [17.725925925925925, 104.42333433199353, 0.7761688869360283], [9.004535147392291, 89.45484555826427, 0.804737203675863], [11.627272727272727, 90.4064886645471, 0.8051597766035314], [17.47087378640777, 101.39222894490797, 0.7749177777340134], [12.672897196261681, 101.07636617656239, 0.782319737800437], [11.02914798206278, 99.05450507851393, 0.7851278607015046], [9.563636363636364, 90.84487866564169, 0.8056543888731654], [13.294663573085847, 96.25781705208115, 0.7869619061772428]]
    training_labels = [70, 45, 71, 71, 71, 71, 71, 36, 38, 1, 1, 47, 48, 1, 67, 67, 71, 46, 55, 1, 38, 70, 71, 63, 49, 38, 45, 71, 71, 71, 1, 45, 38, 63, 33, 68, 32, 63, 20, 67, 67, 58, 70, 59, 1, 70, 71, 71, 4, 59, 45, 59, 48, 58, 33, 31, 1, 36, 41, 1, 43, 1, 70, 57, 45, 31, 16, 57, 30, 57, 70, 53, 71, 64, 71, 70, 45, 45, 47, 5, 32, 57, 12, 71, 67, 46, 71, 13, 30, 32, 39, 59, 1, 33, 33, 1, 45, 30, 34, 48, 71, 57, 57, 64, 71, 63, 63, 16, 47, 41, 67, 70, 67, 39, 32, 65, 47, 12, 1, 15, 49, 40, 63, 45, 15, 39, 40, 64, 47, 64, 1, 5, 63, 14, 45, 57, 64, 70, 5, 70, 58, 49, 8, 33, 59, 43, 63, 63, 57, 57, 45, 14, 1, 58, 45, 63, 70, 36, 52, 27, 57, 58, 40, 51, 44, 57, 66, 64, 62, 41, 71, 58, 0, 65, 30, 62, 62, 52, 49, 51, 63, 66, 62, 69, 39, 66, 30, 57, 31, 0, 59, 45, 66, 44, 56, 69, 11, 2, 0, 51, 0, 67, 11, 67, 24, 0, 1, 56, 69, 65, 39, 34, 63, 57, 56, 58, 46, 70, 70, 2, 67, 68, 11, 63, 51, 55, 67, 17, 33, 51, 44, 64, 11, 0, 65, 34, 71, 68, 62, 12, 47, 56, 13, 57, 45, 56, 14, 39, 46, 56, 52, 56, 49, 64, 16, 25, 33, 12, 46, 11, 14, 15, 31, 68, 71, 24, 68, 11, 0, 23, 65, 15, 0, 55, 51, 0, 0, 64, 54, 71, 33, 69, 59, 38, 62, 25, 0, 57, 0, 2, 0, 69, 57, 33, 59, 30, 45, 71, 49, 39, 67, 57, 0, 67, 11, 47, 11, 33, 1, 69, 66, 57, 62, 18, 63, 62, 2, 42, 49, 45, 0, 31, 56, 63, 45, 11, 58, 56, 57, 62, 1, 0, 35, 41, 59, 41, 42, 55, 47, 54, 10, 48, 55, 48, 55, 71, 71, 44, 65, 0, 43, 41, 26, 55, 50, 33, 71, 65, 71, 57, 50, 53, 24, 66, 1, 1, 48, 44, 26, 26, 58, 43, 15, 68, 44, 26, 50, 51, 0, 44, 66, 2, 11, 47, 59, 42, 1, 67, 66, 68, 11, 50, 41, 26, 52, 60, 60, 67, 1, 11, 11, 1, 27, 29, 61, 66, 1, 53, 15, 16, 47, 64, 2, 25, 69, 11, 65, 67, 50, 18, 67, 11, 29, 29, 33, 18, 30, 65, 37, 59, 52, 21, 11, 35, 0, 27, 17, 59, 17, 48, 18, 26, 11, 0, 71, 41, 71, 57, 34, 42, 40, 40, 19, 41, 48, 11, 54, 42, 66, 17, 48, 11, 49, 49, 64, 62, 11, 0, 67, 50, 49, 66, 11, 1, 11, 24, 32, 33, 34, 58, 58, 42, 47, 46, 5, 47, 31, 46, 54, 46, 31, 13, 27, 54, 48, 59, 58, 31, 48, 58, 53, 54, 48, 46, 68, 59, 31, 64, 55, 64, 59, 31, 65, 53, 12, 71, 13, 46, 39, 36, 59, 65, 55, 68, 34, 32, 53, 31, 46, 47, 58, 59, 14, 53, 64, 53, 68, 65, 47, 32, 31, 12, 13, 46, 68, 43, 68, 21, 13, 46, 14, 53, 55, 55, 55, 39, 47, 3, 71, 19, 59, 18, 31, 64, 48, 18, 46, 28]
    
    """ Initialize Softmax Regressor with the above parameters """
    
    regressor = SoftmaxRegression(input_size, num_classes, lamda)
    
    """ Run the L-BFGS algorithm to get the optimal parameter values """
    
    opt_solution  = scipy.optimize.minimize(regressor.softmaxCost, regressor.theta, 
                                            args = (training_data, training_labels,), method = 'L-BFGS-B', 
                                            jac = True, options = {'maxiter': max_iterations})
    opt_theta     = opt_solution.x
    
    """ Load MNIST test images and labels """
    
    test_data   = [[29.37292817679558, 136.38718075316436, 0.6621214935909344], [23.275949367088607, 126.59954190056295, 0.6904461903350133], [26.46315789473684, 120.14224773045996, 0.709173835657075], [31.22252747252747, 129.2594032273142, 0.6800805944766904], [27.844155844155843, 108.75552780376623, 0.7287637834543137], [28.502702702702702, 132.2768075818905, 0.6781551409525938], [28.03804347826087, 125.96393302222614, 0.6933910758240335], [33.27173913043478, 125.08793637698317, 0.6943205690487598], [30.483695652173914, 130.76896647935303, 0.67678542021189], [27.599476439790575, 108.13972767544699, 0.733671867786908], [25.131926121372032, 128.43677420416842, 0.6813672673230541], [26.280748663101605, 124.70762957801058, 0.69768574908648], [31.356200527704484, 124.30846230802017, 0.6963650656983491], [26.198492462311556, 127.90887468268176, 0.6857880556802873], [25.651715039577837, 103.96560571627576, 0.7432728233384911], [27.142857142857142, 123.28766340085119, 0.6993854492709367], [28.835164835164836, 126.65377740551801, 0.6924919356396438], [30.502762430939228, 126.70122003349857, 0.6945060553123834], [29.16576086956522, 128.74593960271127, 0.6837324361765288], [27.379032258064516, 109.85374105782817, 0.7272872012259438], [30.05292479108635, 127.64114125409246, 0.6864688463165528], [27.306010928961747, 122.8410360185601, 0.702562538133008], [26.476964769647697, 124.40752646576833, 0.6958709335723452], [28.25537634408602, 130.66267817089758, 0.6757675727094254], [25.67479674796748, 106.94639027543849, 0.7337721890476288], [26.212201591511935, 128.74597140453915, 0.6796703634611837], [25.75461741424802, 125.60573137981763, 0.6915953678191875], [28.809264305177113, 123.9271275164582, 0.6944133150707674], [29.810526315789474, 127.99541037668142, 0.6817520674895067], [25.2532981530343, 111.81255137318752, 0.718775416571083], [28.107142857142858, 128.7298355916691, 0.6813619995312267], [27.632275132275133, 125.82450974765601, 0.6934691767544049], [28.57029177718833, 123.13729975483618, 0.7010521250300763], [26.940379403794037, 126.25138391466578, 0.6878491927323919], [24.851948051948053, 113.04461949391289, 0.7152507316214491], [29.893557422969188, 127.60451929085475, 0.6809355004124584], [30.255555555555556, 122.76033848834778, 0.6943391996412959], [27.80053908355795, 123.03782771252777, 0.6976367535015283], [29.78609625668449, 131.99988566584793, 0.6687994150175952], [26.428571428571427, 105.37753992522228, 0.7308567786579259], [30.093333333333334, 122.01651214524452, 0.6962251871135698], [27.616, 125.29056621503649, 0.6902535158709798], [26.554376657824935, 130.50356998739247, 0.6790509121259092], [27.536585365853657, 132.81258968539194, 0.6659997141632128], [25.24869109947644, 103.46173241565772, 0.7359546478668508], [26.46388888888889, 125.0402535279592, 0.6846813725490196], [26.425531914893618, 122.36725120730483, 0.6931657618799733], [27.53887399463807, 123.34773501557704, 0.6952014292544224], [30.622535211267607, 160.45090881221674, 0.5836395909897747], [23.484931506849314, 121.68045788023635, 0.6893265404405242], [26.743243243243242, 157.9163224107345, 0.5823997527621108], [24.690104166666668, 127.38026797826838, 0.6839192963223971], [27.002695417789756, 166.83088855546077, 0.5558595887733563], [22.68766404199475, 120.50007646241242, 0.6905939946071886], [23.79045092838196, 133.64906500098118, 0.6552273498916138], [26.67750677506775, 130.80945285647758, 0.6675755810875205], [24.810880829015545, 122.19733714006517, 0.6901081916537867], [24.63157894736842, 119.2412055608829, 0.6996552369243927], [24.623342175066313, 123.76075021122222, 0.6826925607220863], [25.54089709762533, 131.07613923179554, 0.6616178911044965], [26.473118279569892, 131.6078316957675, 0.6688513845649681], [27.64041994750656, 122.88272763704796, 0.6855085115670013], [23.815303430079155, 123.39028917070512, 0.6884987558750345], [27.505291005291006, 124.77061125443046, 0.6783596837944664], [22.74869109947644, 129.02364781109952, 0.6692550890232404], [27.29708222811671, 133.7455972927277, 0.6592657789387013], [23.984536082474225, 129.87383620679074, 0.6664025580803079], [25.180628272251308, 125.16608325028238, 0.6769833000084485], [23.73560209424084, 125.96591343109253, 0.677253539327456], [23.798955613577025, 130.45265524744227, 0.6617539976116273], [24.761904761904763, 133.61410598278005, 0.6531365313653137], [23.70509383378016, 125.54777210671047, 0.6778114606939989], [21.3502538071066, 121.72319139963629, 0.6850229942294737], [26.842391304347824, 127.07887821953877, 0.6719708418526091], [25.293650793650794, 130.19704419194375, 0.6622423718197273], [26.144385026737968, 133.83816272384215, 0.6540322823048483], [23.206349206349206, 126.36991722911011, 0.6731726329675601], [21.446524064171122, 119.86528504105152, 0.6873822412297754], [24.489247311827956, 128.80340045533433, 0.6627861854870004], [23.055408970976252, 136.9498639831608, 0.6413818314750502], [23.709923664122137, 134.08410318845907, 0.650098532953799], [23.799479166666668, 127.84562578936652, 0.6663546152405917], [24.013192612137203, 124.13335304128692, 0.6736557958504661], [33.04322766570605, 147.45507105718866, 0.6392262708052182], [32.09836065573771, 137.26668131079785, 0.6488533257126528], [33.40625, 144.29006112146337, 0.6400088287227781], [30.30225988700565, 125.28967512906415, 0.6847231108267576], [29.97167138810198, 129.07576996853874, 0.6889368350569154], [30.737430167597765, 137.39196123425634, 0.6568606398969293], [30.765333333333334, 128.2943147629552, 0.688124632569077], [30.616216216216216, 143.85456382489622, 0.6323066793474285], [30.642659279778393, 139.80644360329467, 0.6519110343338372], [33.11647727272727, 132.40866012603348, 0.6754359591100421], [32.84347826086957, 145.2339354224273, 0.6327705594024742], [32.6, 141.7602555227448, 0.630709286384299], [30.062678062678064, 141.56063405313643, 0.6456717835100491], [32.41025641025641, 165.65547374221774, 0.5454082745582782], [32.3150289017341, 124.48872962238187, 0.6936787251718148], [29.892957746478874, 139.0118142748396, 0.6418855022914091], [29.631884057971014, 137.74117621810223, 0.6536919993833822], [29.25, 140.24821789017398, 0.637546468401487], [30.988538681948423, 138.11511659728018, 0.6513473171498154], [31.485714285714284, 139.27697071415471, 0.63444360333081], [30.35632183908046, 139.59056158697015, 0.6468899521531101], [29.060693641618496, 139.46716362065828, 0.6383219954648526], [30.47457627118644, 131.99945153676262, 0.6693072508285507], [32.402898550724636, 166.27424907553853, 0.5394086797902258], [29.46961325966851, 139.62387139507666, 0.6525908614715126], [29.425714285714285, 128.30227036761798, 0.6716231022069181], [30.472463768115944, 140.04679731287186, 0.6482598991485492], [32.00804289544236, 139.3953208711183, 0.6332022029897718], [31.059620596205963, 131.6496008052887, 0.6724254171582673], [32.50728862973761, 163.28437948113896, 0.5516423975618016], [29.056603773584907, 128.85959082721664, 0.6669433147979086], [32.39017341040462, 144.54385110041116, 0.6305607559953642], [32.679452054794524, 133.10483868926565, 0.6496324816240812], [30.529411764705884, 142.70707376978459, 0.6351543942992874], [31.21067415730337, 127.88473451430504, 0.659288037585833], [29.47826086956522, 142.37564476310482, 0.6343219118917363], [28.969529085872576, 122.58325146761037, 0.6814184131736527], [32.05367231638418, 133.3927103554548, 0.6586629470957457], [30.473684210526315, 136.79043430136812, 0.6335133087051246], [31.867469879518072, 142.91977633176586, 0.6269762845849802], [32.02623906705539, 133.23512381804323, 0.6510184287099903], [33.02923976608187, 136.23921283604727, 0.643989296006587], [33.66115702479339, 147.05877637341092, 0.6030047132757266], [31.558823529411764, 130.52057850072222, 0.6649420529801324], [31.67584097859327, 148.07149033106137, 0.6041972717733474], [33.06042296072508, 133.61155137393249, 0.6400718061234666], [33.416666666666664, 145.7832815316285, 0.6173559745806855], [31.22905027932961, 126.6209877267761, 0.6606447749276375], [33.61714285714286, 135.75416178808152, 0.64281269446173], [33.37869822485207, 139.16028831850332, 0.6254607032572965], [33.05172413793103, 135.7758781474995, 0.6520252217591108], [32.42777777777778, 146.05025481072585, 0.6041888156495854], [32.50588235294118, 140.0220021778569, 0.6218961625282167], [33.54246575342466, 137.95932408403257, 0.6350806451612904], [32.34571428571429, 147.73078354803656, 0.5984217922386769], [34.1622418879056, 138.56104087517562, 0.6141797197032152], [33.31686046511628, 145.23960119640358, 0.6160997484414306], [32.60227272727273, 142.16791931826575, 0.6076965365585486], [31.087818696883854, 135.59168651530322, 0.6179337231968811], [33.99696048632219, 149.2679777402129, 0.5849822953551344], [30.481792717086833, 132.973336662431, 0.6418458311484007], [29.380697050938338, 133.4512785554734, 0.629600316580926], [29.538888888888888, 128.3663444392533, 0.6578059503118291], [28.132231404958677, 135.3835792611278, 0.6279387376841283], [31.991150442477878, 170.90677584394695, 0.49086824885242697], [29.57983193277311, 130.53166907533767, 0.6543650793650794], [30.26558265582656, 134.22637188058235, 0.6266692102251049], [31.123595505617978, 143.55867737296666, 0.6044636712221021], [31.913793103448278, 132.9369614038973, 0.6334896810506566], [32.24929178470255, 143.6303471089357, 0.6037664426989685], [31.261971830985914, 135.17630705755377, 0.631391429947039], [31.108333333333334, 130.38348492478033, 0.6312403732898433], [31.478991596638654, 127.13755186501578, 0.6615256741780569], [32.122093023255815, 142.83020774704053, 0.6069752461580933], [30.27956989247312, 131.04000258871338, 0.639905029897995], [30.76566757493188, 169.22498019113286, 0.48963014172139646], [30.54054054054054, 137.98928782974855, 0.6330566837365355], [31.097142857142856, 129.43056397129075, 0.651600912393343], [31.31908831908832, 139.56795245068767, 0.628821354495446], [30.889855072463767, 140.30071939621152, 0.615732832251452], [30.497222222222224, 131.41159484941542, 0.6567537281268856], [32.366279069767444, 129.48997798257187, 0.6472131147540984], [31.71549295774648, 134.36060956256114, 0.641690281713619], [32.04424778761062, 134.21428049194188, 0.6406428454886605], [31.18384401114206, 120.17698905145429, 0.6832546603728298], [30.673295454545453, 125.12444819734344, 0.6776680317995664], [30.581920903954803, 137.17746987222725, 0.6349441157133465], [30.826446280991735, 132.6784447753403, 0.6415034744156665], [22.445273631840795, 109.69305326051133, 0.7808364365511314], [25.435695538057743, 127.50579233630926, 0.721236484613252], [23.71979434447301, 104.80027768038428, 0.7918107266337114], [23.45273631840796, 103.26906447549312, 0.785720309205903], [21.954545454545453, 102.82449017061673, 0.792906145919326], [22.19106699751861, 101.83760388131036, 0.7888331136599456], [22.32535885167464, 110.91141512628198, 0.7760183591508892], [19.616136919315405, 101.31765612541243, 0.7919644636806287], [22.228855721393035, 115.48429932218293, 0.7619678934778223], [23.321782178217823, 105.22179753494012, 0.7781853063988263], [24.072727272727274, 111.83424055005452, 0.7718382183244865], [20.22409638554217, 104.1356078682506, 0.7859921066178573], [24.145679012345678, 105.96282848115064, 0.78716794890405], [21.044554455445546, 106.25799137447405, 0.777326209287785], [25.0, 130.8846747914599, 0.7234869197340777], [21.344059405940595, 97.34927235268965, 0.8003368637414714], [20.68058968058968, 106.49737469006396, 0.7837853367042059], [24.63613231552163, 106.35053374135454, 0.7773205175183922], [22.133004926108374, 113.53620729593833, 0.770692738074638], [24.42105263157895, 108.85148716636117, 0.7733659480061437], [22.778054862842893, 108.62005921709111, 0.7797224940986816], [23.657635467980295, 103.60829631594703, 0.7852745142340714], [24.861892583120206, 111.06019102003961, 0.7770523200139288], [21.051344743276285, 104.50519924163477, 0.786003155026531], [22.9675, 131.8056192237858, 0.7182873149259704], [22.169950738916256, 94.72303459187515, 0.8053511324091506], [20.764411027568922, 111.17719351445749, 0.7744037230948225], [20.720588235294116, 104.0460316451177, 0.7844589937973812], [21.559405940594058, 107.51681945441216, 0.7835829593799173], [20.840294840294842, 104.20187018993921, 0.7828438282081523], [23.066838046272494, 113.35051402100689, 0.7717455446713088], [24.616751269035532, 122.3337935261759, 0.7405718295035959], [20.654589371980677, 106.9815680892641, 0.7833224095811238], [24.659147869674186, 104.91985873531604, 0.779950458982952], [22.16504854368932, 113.15954119874648, 0.7700982283289314], [24.86783042394015, 107.94855558898033, 0.7759962549008134], [24.81219512195122, 103.03530848114806, 0.7901488243754954], [24.709183673469386, 101.82285847607913, 0.7867715078630897], [22.94206549118388, 107.94653665637469, 0.7832241769214955], [21.93946731234867, 101.54081530676876, 0.7916933465277374], [22.906329113924052, 114.16729530033142, 0.7672510809690221], [23.588089330024815, 103.00329454663043, 0.7837634096839664], [22.608374384236452, 109.9837713102529, 0.7779887273805992], [21.275609756097563, 107.19563497168446, 0.779292988411565], [24.804020100502512, 115.64263859615713, 0.7649269187525889], [21.213930348258707, 106.49115261004732, 0.777912902478573], [25.316708229426435, 108.25122540848345, 0.7809873640905084], [22.364089775561098, 104.23296540790729, 0.7861264937336053], [20.193627450980394, 104.03802653138287, 0.7888905130828826], [22.81, 101.61983997240311, 0.7893047200370199], [23.546134663341647, 111.07256943706139, 0.7767565178965974], [23.896984924623116, 106.25959123461712, 0.7821335442852538], [22.31358024691358, 108.31687408748793, 0.7843512591972244], [23.31552162849873, 111.16745508842916, 0.7690254063251775], [23.957178841309823, 111.75362913601496, 0.7740571877170205], [24.873096446700508, 107.79868307116271, 0.7777116854534099], [23.705583756345177, 116.33356858635264, 0.7637723734819346], [22.5725, 105.79168406380417, 0.7781212281786335], [23.693506493506494, 110.42408682239463, 0.7793466807165438], [22.1356783919598, 103.50944814566259, 0.7880565897244974], [21.855, 107.07096704815487, 0.7850121742267111], [22.455882352941178, 107.78139315796541, 0.777493530933898], [22.639225181598064, 109.83336771222145, 0.7828335989895041], [22.702564102564104, 103.43550444541147, 0.7936441060519426], [21.64009661835749, 110.07989461882278, 0.7805244594387364], [23.136708860759494, 109.5913371618374, 0.7740429505135388], [24.468827930174562, 120.95320160732336, 0.7530198446937014], [21.43276283618582, 103.83717022559287, 0.7882516552287088], [22.522727272727273, 111.51285159798012, 0.7812228429546866], [22.4175, 111.73540579839526, 0.7680843988996705], [23.316582914572866, 105.11365269564543, 0.7933718380331717], [26.22110552763819, 107.8339490761872, 0.7868706143050597], [15.435185185185185, 100.52894172507763, 0.7819204539797899], [14.249417249417249, 100.78268833506677, 0.7838670320219213], [12.734234234234235, 98.90314103245653, 0.7810143934201508], [16.662763466042154, 102.69353862278723, 0.7810972678471276], [15.353919239904988, 101.580344487044, 0.7808677083956974], [12.606896551724137, 99.81879573866027, 0.7886702373071753], [16.011655011655012, 99.41313395347039, 0.7821584750698399], [10.240534521158128, 100.76563265198041, 0.7854647240653665], [9.963553530751708, 90.31616683776043, 0.8058654318389111], [12.578703703703704, 97.08713752467528, 0.7903646094329412], [12.612676056338028, 91.10445438563818, 0.8013934183219685], [18.530864197530864, 100.23412868199459, 0.7859063421460343], [12.941176470588236, 99.95277174940931, 0.7848896857413218], [11.11111111111111, 94.62497356536664, 0.7981227248568478], [21.645569620253166, 103.68678083963135, 0.7716137971989905], [16.251231527093594, 103.09703484803093, 0.7795633961656194], [19.753694581280786, 102.0354861849942, 0.7802630258006225], [17.455445544554454, 101.01229858743928, 0.7847655657275808], [12.205949656750573, 96.60942275499856, 0.7842791122042169], [10.857142857142858, 89.32999454733081, 0.8105643130870889], [20.843989769820972, 132.28353956852038, 0.7068253920895864], [15.260047281323876, 98.57821566055456, 0.7913647463869651], [10.34375, 87.26059057173393, 0.8089777195281782], [19.995037220843674, 96.11332097635669, 0.7961500393883694], [20.18978102189781, 105.04684897143783, 0.7732684199959847], [9.860730593607306, 91.2106799897229, 0.807685338058229], [12.821100917431192, 95.53805828212538, 0.7924283278480511], [18.295566502463053, 97.51725198684716, 0.792182102980159], [15.071942446043165, 100.7235707874406, 0.7861381342590724], [19.21271393643032, 99.6466228070691, 0.7873763227647047], [18.177777777777777, 137.1939715682403, 0.6958184184835665], [11.527964205816556, 101.48670152974863, 0.7861116280993444], [13.536057692307692, 96.09049509525728, 0.7944277955631015], [18.242130750605327, 102.65505459511196, 0.7840114789381982], [20.478155339805824, 104.8073752541732, 0.7716686529177692], [19.03731343283582, 112.89152165012737, 0.7598020711115645], [14.800469483568076, 91.60490319134894, 0.8050034026388226], [15.834975369458128, 100.75636827677958, 0.7861829096403257], [17.507389162561577, 92.25518038211392, 0.8015609264853978], [18.26, 107.66141330179313, 0.7718638902996445], [21.62469135802469, 104.41122387767851, 0.7791321060084969], [13.317016317016318, 90.43507829125565, 0.811363196840616], [12.962703962703962, 88.144050831777, 0.8123694908757099], [19.11111111111111, 86.06288313612878, 0.8210771121289366], [18.420398009950247, 99.05944113410136, 0.7934521629430676], [17.581907090464547, 91.79269635606397, 0.8096504054233683], [19.303571428571427, 103.84375856793542, 0.7810318233479461]]
    test_labels = [38, 33, 70, 63, 33, 12, 53, 65, 31, 71, 71, 32, 70, 45, 53, 53, 57, 49, 30, 30, 57, 45, 30, 45, 30, 45, 40, 30, 1, 14, 1, 31, 32, 30, 31, 45, 1, 12, 70, 36, 49, 12, 57, 54, 25, 49, 25, 70, 57, 67, 45, 1, 31, 58, 1, 58, 70, 12, 39, 63, 70, 49, 46, 67, 53, 39, 45, 52, 63, 52, 31, 53, 39, 36, 57, 40, 57, 30, 45, 40, 52, 14, 64, 56, 11, 49, 45, 56, 11, 66, 67, 2, 48, 30, 22, 68, 11, 53, 56, 51, 69, 0, 67, 1, 0, 19, 0, 66, 11, 2, 9, 11, 11, 6, 6, 0, 48, 0, 0, 0, 11, 47, 64, 0, 1, 43, 11, 66, 2, 42, 11, 45, 0, 31, 69, 55, 63, 62, 11, 66, 42, 45, 57, 68, 48, 55, 67, 11, 49, 57, 56, 69, 3, 3, 43, 66, 49, 0, 0, 58, 11, 2, 0, 11, 0, 68, 11, 7, 48, 66, 49, 0, 42, 11, 55, 67, 47, 47, 0, 2, 16, 26, 34, 11, 11, 54, 16, 55, 35, 2, 19, 35, 48, 1, 54, 43, 43, 54, 34, 70, 34, 26, 24, 26, 0, 25, 24, 11, 23, 24, 58, 25, 1, 67, 67, 47, 14, 64, 69, 0, 59, 26, 71, 71, 25, 16, 12, 20, 12, 68, 71, 34, 34, 34, 69, 38, 69, 34, 71, 59, 71, 70, 63, 64, 33, 68, 32, 68, 46, 64, 64, 12, 31, 53, 64, 64, 64, 40, 53, 53, 14, 54, 38, 53, 36, 53, 55, 12, 32, 31, 53, 39, 13, 31, 31, 53, 36, 32, 71, 64, 15, 65, 71, 71, 32, 31, 68, 58, 58, 59]
    
    """ Obtain predictions from the trained model """
    
    predictions = regressor.softmaxPredict(opt_theta, test_data)
    print(predictions)
    
    """ Print accuracy of the trained model """
    
    #correct = test_labels[:, 0] == predictions[:, 0]
    #print """Accuracy :""", numpy.mean(correct)
    
executeSoftmaxRegression()